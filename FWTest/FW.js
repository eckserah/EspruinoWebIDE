ªlog(a,b){­c;b (b=Ñexceptions.log);±{c=fs.statSync(ÑLOGS)}catch(b){a (a=Ñ
SD CARD ERROR)}console.log(a),cžc.dir?fs.appendFile(ÑLOGS/+b,`${¸Date().toISOString()} ${a}\n`):require(ÑStorage).open(b,Ña).write(`${¸Date().toISOString()} ${a}\n`)}ªsaveSettings(){£(!Pip.isSDCardInserted())°¸Error(Ñ Can't save settings - no SD card);fs.writeFile(Ñ
settings.json,JSON.stringify(settings))}ªconfigureAlarm(){£(alarmTimeoutž(console.log(ÑCancelling existing alarm),clearTimeout(alarmTimeout)),alarmTimeout=·,settings.alarm.enabledžsettings.alarm.timež!Pip.demoMode){­b=Pip.getDateAndTime();­a=¸Date(settings.alarm.time);settings.alarm.snoozeTimež(a=¸Date(settings.alarm.snoozeTime)),a.getTime()Žb.getTime()ž(console.log(`Alarm time (${a}) is in the past, setting to tomorrow`),a=Pip.getDateAndTime(),a.setDate(b.getDate()+1),a.setHours(¸Date(settings.alarm.time).getHours()),a.setMinutes(¸Date(settings.alarm.time).getMinutes()),¾settings.alarm.snoozeTime),settings.alarm.snoozeTime (settings.alarm.time=a.getTime()),alarmTimeout=setTimeout(ªa(){£(Pip.sleepingŠÑBUSY)«setTimeout(a,1e4);settings.alarm.repeat (settings.alarm.enabled=!1);­b=Pip.sleeping;b?wakeFromSleep(showAlarm):showAlarm(),console.log(ÑALARM!)},a.getTime()-b.getTime()),console.log(`Alarm set to ${a} (${((a.getTime()-b.getTime())/60/6e4).toFixed(3)} hours away)`)}}ªwakeOnLongPress(){£(BTN_POWER.read()){­a=setWatch(a¢{clearTimeout(b)},BTN_POWER,{edge:Ñfalling});­b=setTimeout(b¢{clearWatch(a),settings.longPressToWake=!1,saveSettings(),wakeFromSleep(playBootAnimation)},2e3)}}ªplayBootAnimation(b){console.log(ÑPlaying boot animation);­a=¶;«b‹·ž(b=!0),Pip.removežPip.remove(),Pip.removeSubmenužPip.removeSubmenu(),Pip.videoStart(Ñ
BOOT/BOOT.avi,{x:40}),Pip.fadeOn(),¸Promise((e,f)¢{­c=()¢{Pip.removeListener(ÑvideoStopped,c),Pip.audioStart(ÑBOOT/BOOT_DONE.wav),bž(a=setTimeout(a¢{Pip.fadeOff().then(a¢{showMainMenu(),setTimeout(a¢Pip.fadeOn([LCD_BL]),200)})},2e3)),e()};­d=()¢{Pip.removeListener(ÑvideoStopped,d),g.clear(1).drawPoly([90,45,90,35,390,35,390,45]).drawPoly([90,275,90,285,390,285,390,275]);­a=settings.userName?`Pip-Boy assigned to ${settings.userName}`:ÑSuccess!;g.setFontMonofonto18().setFontAlign(0,-1).drawString(a,240,250),Pip.videoStart(ÑUI/THUMBUP.avi,{x:160,y:55}),Pip.on(ÑvideoStopped,c)};Pip.on(ÑvideoStopped,d),Pip.remove=ª(){Pip.removeAllListeners(ÑvideoStopped),ažclearTimeout(a)}})}ªcheckBatteryAndSleep(){­a=Pip.measurePin(VBAT_MEAS);£(VUSB_PRESENT.read())«!1;£(a<3.2)«log(`Battery voltage too low (${a.toFixed(2)} V) - shutting down immediately`),clearInterval(),clearWatch(),Pip.sleeping=!0,setTimeout(Pip.off,100),!0;¤£(a<3.5){log(`Battery voltage too low (${a.toFixed(2)} V) - showing battery warning then shutting down`),Pip.sleepingžPip.wake(),clearInterval(),clearWatch();­b=240,c=160;«g.clear(1).fillRect(b-60,c-20,b+60,c-18).fillRect(b-60,c+18,b+60,c+20).fillRect(b-60,c-18,b-58,c+18).fillRect(b+58,c-18,b+60,c+18).fillRect(b+60,c-6,b+68,c+6).setColor(g.blendColor(g.theme.bg,g.theme.fg,.5)).fillRect(b-54,c-14,b-48,c+14),setTimeout(()¢LCD_BL.set(),150),Pip.sleeping=!0,setTimeout(Pip.off,2e3),!0}¤«!1}ªwakeFromSleep(a){Pip.sleeping=ÑBUSY,Pip.wake(),Pip.brightness<10ž(Pip.brightness=20),Pip.modeŠMODE.TESTž(Pip.mode=¶),Pip.addWatches(),setTimeout(c¢{­b=[LCD_BL,LED_RED,LED_GREEN];rd.setupI2C(),a(),Pip.fadeOn(b).then(a¢{Pip.sleeping=!1})},100)}ªsubmenuBlank(a){«ª(){bC.clear(1).setFontMonofonto23(),bC.setFontAlign(0,0).drawString(a,bC.getWidth()/2,bC.getHeight()/2),bC.flip(),Pip.removeSubmenu=ª(){}}}ªshowMainMenu(b){£(Pip.removežPip.remove(),process.env.VERSION<MIN_FW_VER){log(ÑRunning firmware version +process.env.VERSION+Ñ but minimum is +MIN_FW_VER),E.showMessage(Ñ)Please upgrade firmware binary

Running: +process.env.VERSION+Ñ
Minimum required: +MIN_FW_VER);«}Pip.mode=¶,d0=¶,MEAS_ENB.write(0);¬a=setInterval(checkMode,50);Pip.on(Ñknob2,b¢{­a=MODEINFO[Pip.mode];£(aža.submenu){­c=Object.keys(a.submenu);sm0=(sm0+c.length+b)%c.length,drawHeader(Pip.mode),Pip.removeSubmenužPip.removeSubmenu(),¾Pip.removeSubmenu,g.clearRect(BGRECT),a.submenu[c[sm0]](),Pip.knob2Click(b)}}),Pip.on(Ñtorch,torchButtonHandler),Pip.remove=()¢{Pip.removeSubmenužPip.removeSubmenu(),¾Pip.removeSubmenu,Pip.removeAllListeners(Ñknob2),MEAS_ENB.write(1),clearInterval(a),Pip.removeAllListeners(Ñtorch)},Pip.radioOnžsetTimeout(a¢{!(Pip.sleeping rd.isOn())ž(rd.enable(!0),Pip.modeŠMODE.RADIO)ž(Pip.audioStart(ÑUI/RADIO_ON.wav),Pip.removeSubmenužPip.removeSubmenu(),¾Pip.removeSubmenu,submenuRadio())},2e3),settings.alarm.snoozeTimežPip.on(Ñknob1,a¢{aŠ0žsettings.alarm.snoozeTimež(E.stopEventPropagation(),¾settings.alarm.snoozeTime,saveSettings(),Pip.audioStop(),configureAlarm(),clearInterval(),Pip.videoStop(),bH.clear().flip(),bC.clear(1),bC.setFontMonofonto36().setFontAlign(0,0),bC.drawString(ÑSNOOZE CANCELED,200,100).flip(),drawFooter(),setTimeout(showMainMenu,3e3))})}ªenterDemoMode(){ªstep(){Pip.demoTimeout=·;¬timeToNext=SEQ[s][0],cmd=SEQ[s][1];±{print(ÑRunning:,cmd),eval(cmd)}catch(a){print(a)}s˜,s‘SEQ.lengthž(s=0,console.log(ÑLoop demo, used,process.memory().usage,Ñvars)),Pip.demoTimeout=setTimeout(step,timeToNext)}Pip.removežPip.remove(),¾Pip.remove,clearWatch(),setWatch(ª(){E.reboot()},BTN_POWER,{debounce:50,edge:Ñrising,repeat:!0}),settings.idleTimeout=0,Pip.kickIdleTimer();¬SEQ=[[14e3,ÑplayBootAnimation(0);],[2e3,Ñ)showMainMenu(); Pip.demoMode = MODE.STAT;],[200,ÑPip.emit('knob1',20)],[1e3,ÑPip.emit('knob1',-1)],[1e3,ÑPip.emit('knob1',-1)],[1e3,ÑPip.emit('knob1',-1)],[1e3,ÑPip.emit('knob1',-1)],[1e3,ÑPip.emit('knob1',-1)],[1e3,ÑPip.emit('knob1',-1)],[1e3,ÑPip.emit('knob1',-1)],[1e3,ÑPip.emit('knob1',-1)],[1e3,ÑPip.emit('knob1',-1)],[2e3,ÑPip.emit('knob1',-1)],[6e3,ÑPip.emit('knob2',1)],[3e3,ÑPip.emit('knob2',1)],[3e3,ÑPip.emit('knob1',-1)],[3e3,ÑPip.emit('knob1',-1)],[2e3,ÑPip.demoMode = MODE.INV;],[2e3,ÑPip.emit('knob1',0)],[4e3,ÑPip.emit('knob1',-20)],[4e3,ÑPip.emit('knob1',15)],[2e3,ÑPip.emit('knob1',0)],[2e3,ÑPip.emit('knob1',-1)],[2e3,ÑPip.emit('knob1',0)],[2e3,ÑPip.emit('knob1',0)],[2e3,ÑPip.emit('knob2',1)],[6e3,ÑPip.emit('knob2',1)],[5e3,ÑPip.demoMode = MODE.DATA;],[5e3,ÑPip.emit('knob2',1)],[5e3,ÑPip.emit('knob1',-1)],[5e3,ÑPip.emit('knob1',-1)],[5e3,ÑPip.emit('knob1',-1)],[5e3,ÑPip.emit('knob1',-1)],[3e3,ÑPip.demoMode = MODE.MAP;],[3e3,ÑPip.emit('knob1',-1)],[3e3,ÑPip.emit('knob1',-1)],[3e3,ÑPip.emit('knob1',-1)],[3e3,ÑPip.emit('knob1',-1)],[3e3,ÑPip.emit('knob1',-1)],[1e3,ÑPip.demoMode = MODE.RADIO;],[1e3,ÑPip.emit('knob1',-1)]],s=0;step()}ªleaveDemoMode(){Pip.demoTimeoutž(clearTimeout(Pip.demoTimeout),Pip.demoTimeout=·),clearWatch(),Pip.demoMode=0,Pip.addWatches()}ªfactoryTestMode(){ªe(){£(bžftm.currentTest<ftm.tests.length){Pip.removeSubmenužPip.removeSubmenu();­a=ftm.tests[ftm.currentTest];a.testTime=Date().toLocalISOString();­b=getTime();a.fn?a.fn(a).then(c¢{a.testDuration=Math.round(getTime()-b),a.pass=c,ftm.currentTest˜,h(),e()}):(ftm.currentTest˜,e())}¤b=!1,ftm.currentTest=¶,d()}ªi(c){console.log(ÑTesting inputs),Pip.removežPip.remove(),clearWatch(),c.inputs=[{pin:MODE_SELECTOR,name:ÑMode},{pin:BTN_POWER,name:ÑPower},{pin:BTN_TORCH,name:Ñ
Flashlight},{pin:BTN_PLAY,name:ÑPlay},{pin:BTN_TUNEUP,name:ÑTune Up},{pin:BTN_TUNEDOWN,name:Ñ	Tune Down},{pin:KNOB1_A,name:ÑKnob A},{pin:KNOB1_B,name:ÑKnob B},{pin:KNOB1_BTN,name:Ñ
Knob Press},{pin:KNOB2_A,name:ÑThumbwheel A},{pin:KNOB2_B,name:ÑThumbwheel B}];®e=[.25,.75];®d=[.1,.3,.5,.7,.9];«c.inputLevels=¸Array(c.inputs.length),c.inputPassed=¸Array(c.inputs.length).fill(!1),g.setFontMonofonto18().clearRect(0,56,479,319).setColor(Ñ#00C000).drawString(Ñ&Input test: press buttons & turn knobs,a,56),c.inputs.forEach((f,b)¢{g.setColor(Ñ#008000).drawString(`${f.name.padStart(12,Ñ )}:`,a,80+b*20,!0),g.setColor(Ñ#003300).fillRect(a+126,80+b*20,a+216,97+b*20),bŠ0?(d.forEach(c¢{g.clearRect(a+131+c*80,80+b*20,a+131+c*80,97+b*20)}),g.clearRect(a+131+d[4]*80,80+b*20,a+216,97+b*20),c.inputLevels[b]=¸Array(d.length).fill(!1)):(e.forEach(c¢{g.clearRect(a+131+c*80,80+b*20,a+131+c*80,97+b*20)}),c.inputLevels[b]=¸Array(2).fill(!1)),f.pin.getInfo().analog?f.pin.mode(Ñanalog):(f.pin.mode(Ñinput),f.pin.mode(Ñinput_pullup))}),¸Promise((h,j)¢{ªi(a){a (Pip.removeListener(Ñknob1,i),h(!0))}­f=setInterval(ª(){c.inputs.forEach((l,k)¢{­j;c.inputPassed[k] (l.pin.getInfo().analog?j=l.pin.analog():j=l.pin.read()?1:0,kŠ0?d.forEach((b,a)¢{j>(aŠ0?0:d[a-1])žj<bž(c.inputLevels[k][a]=j)}):j<e[0]?c.inputLevels[k][0]=j:j>e[1]ž(c.inputLevels[k][1]=j),g.setColor(0,1,0).fillRect(a+129+j*80,80+k*20,a+133+j*80,97+k*20),c.inputLevels[k].includes(!1) (g.drawString(ÑOK,a+230,80+k*20),c.inputPassed[k]=!0,l.pin.mode(Ñinput),c.inputPassed.includes(!1) (clearInterval(f),g.setColor(0,1,0).drawString(Ñ)Input test: PASS - press knob to continue,a,56,!0),Pip.addWatches(),b?h(!0):Pip.on(Ñknob1,i))))})},50);Pip.remove=()¢{clearInterval(f)}})}ªj(c){console.log(ÑTesting LEDs),Pip.removežPip.remove(),g.setFontMonofonto18().setFontAlign(-1,-1).clearRect(0,56,479,289).setColor(Ñ#00C000).drawString(ÑLED test,a,56);­e=[LED_RED,LED_GREEN,LED_BLUE,LED_TUNING];­d=0;­f=setInterval(ª(){e.forEach((a,b)¢{a.write(dŠb?1:0)}),d=(d+1)%4},500);«Pip.remove=()¢{clearInterval(f),e.forEach(a¢a.write(0))},¸Promise((a,d)¢{setTimeout(()¢{E.showPrompt(Ñ%Red, green, blue & white
LEDs all OK?).then(d¢{£(d){c.LEDsOK=!0,console.log(Ñ!LED test passed - checking pixels),Pip.remove(),g.setColor(.2,1,.2).fillRect(0,0,479,319);ªd(e){Pip.removeListener(Ñknob1,d),E.showPrompt(ÑAll pixels look OK?).then(d¢{g.clearRect(0,0,479,319),d?(c.pixelsOK=!0,console.log(ÑPixel test passed),a(!0)):(c.pixelsOK=!1,console.log(ÑPixel test failed),b=!1,a(!1))})}Pip.on(Ñknob1,d)}¤c.LEDsOK=!1,console.log(ÑLED test failed),b=!1,a(!1)})},2e3)})}ªk(c){console.log(ÑTesting measurements),Pip.removežPip.remove(),c.meas=[{pin:RADIO_AUDIO,name:ÑFM radio,divider:1,min:.7,max:1.1,offMax:.3},{pin:VUSB_MEAS,name:Ñ
USB supply,divider:2,min:4,max:5.6,offMax:.3},{pin:VBAT_MEAS,name:ÑBattery,divider:2,min:3.5,max:4.4},{pin:CHARGE_STAT,name:ÑCHRG status,divider:1,min:2.7,max:4,offMax:.3},{name:ÑVDD,min:3.2,max:3.5},{name:ÑTemperature,min:15,max:50}],c.measLevel=¸Array(c.meas.length),c.measOff=¸Array(c.meas.length),c.measPassed=¸Array(c.meas.length).fill(¶),lastValue=¸Array(c.meas.length),g.setFontMonofonto18().setFontAlign(-1,-1).clearRect(0,56,479,289).setColor(Ñ#00C000).drawString(ÑMeasurements test,a,56);­d=(j,h,b,d,c)¢{cŠ¶ž(c=3),dŠ¶ž(d=Ñ#00FF00);­e=b.offMax?0:b.min-(b.max-b.min)*.1;­i=b.max+(b.max-b.min)*.1;­f=a+131+(j-e)/(i-e)*80;g.setColor(d).fillRect(f-c/2,h,f+c/2,h+17)};c.meas.forEach((b,c)¢{g.setColor(Ñ#008000).drawString(`${b.name.padStart(12,Ñ )}:`,a,85+c*25,!0),g.setColor(Ñ#003300).fillRect(a+126,85+c*25,a+216,102+c*25),d(b.min,85+c*25,b,0,1),d(b.max,85+c*25,b,0,1),b.offMaxžd(b.offMax,85+c*25,b,0,1),b.pinžb.pin.mode(Ñanalog)});­e=!1;«¸Promise((j,k)¢{ªi(a){a (clearInterval(h),Pip.removeListener(Ñknob1,i),rd.enable(0),e (b=!1),j(e))}Pip.on(Ñknob1,i);­f=0;­h=setInterval(ª(){£(˜fŠ5žrd.enable(1),(f<5 f>6)žc.meas.forEach((f,b)¢{­e;­h=ÑV;­i=2;£(f.nameŠÑVDD){e=0;§(­a=0;a<20;a˜)e–E.getAnalogVRef()/20}¤£(f.nameŠÑTemperature){e=0;§(­a=0;a<20;a˜)e–E.getTemperature()/20;h=ÑC,i=1}¤e=Pip.measurePin(f.pin,100,f.divider);g.setColor(Ñ#00FF00).setFontMonofonto18().drawString(`${e.toFixed(i)} ${h}  `,a+230,85+b*25,!0),lastValue[b]žd(lastValue[b],85+b*25,f,Ñ#006600),d(e,85+b*25,f),lastValue[b]=e,f.offMaxže<f.offMaxž(c.measOff[b]=e),e‘f.minžeŽf.maxž(c.measLevel[b]=e),c.measLevel[b]ž(c.measOff[b] !f.offMax)?(c.measPassed[b]=!0,g.drawString(ÑOK  ,a+310,85+b*25,!0)):f.offMax g.setColor(Ñ#FF2200).drawString(ÑFAIL,a+310,85+b*25,!0).setColor(Ñ#00FF00)}),!(c.measPassed.includes(!1) c.measPassed.includes(¶) e))e=!0,b?(clearInterval(h),Pip.removeListener(Ñknob1,i),rd.enable(0),j(!0)):g.setColor(0,1,0).drawString(Ñ#Measurement test: PASS - press knob,a,56,!0);¤{­b=c.meas.findIndex(a¢a.pinŠVUSB_MEAS);­d=Ñ                               ;c.measLevel[b]?c.measOff[b]?(b=c.meas.findIndex(a¢a.pinŠCHARGE_STAT),c.measOff[b] (d=ÑRe-connect charging cable)):d=ÑDisconnect charging cable:d=ÑConnect charging cable,g.drawString(d,a,260,!0)}},50);Pip.remove=()¢{clearInterval(h)}})}ªl(d){£(console.log(ÑTesting SD card),Pip.removežPip.remove(),g.setFontMonofonto18().setFontAlign(-1,-1).clearRect(0,56,479,289).setColor(Ñ#00C000).drawString(ÑSD card test,a,56),!Pip.isSDCardInserted())«¸Promise((a,c)¢{E.showPrompt(ÑNo SD card inserted!,{buttons:{OK:!0}}).then(c¢{b=!1,a(!1)})});¤{®e=fs.getFree();®h=(e.freeSectors*e.sectorSize/1e6).toFixed(0);®i=(e.totalSectors*e.sectorSize/1e6).toFixed(0);®m=`${h}/${i} MB free`;­f,j;d.sdInfo=[{name:ÑSize,value:i,units:ÑMB,min:240,max:64e3},{name:ÑUsed,value:i-h,units:ÑMB,min:10,max:200},{name:ÑFree,value:h,units:ÑMB,min:20,max:64e3},{name:ÑFiles,value:ÑCounting,units:'',min:50,max:1e4},{name:ÑWrite speed,value:¶,units:ÑkB/s,min:50,max:1e4},{name:Ñ
Read speed,value:¶,units:ÑkB/s,min:200,max:1e4},{name:Ñ	Integrity,value:ÑChecking,units:''}];­k=!0;­l;«d.sdInfo.forEach((b,d)¢{£(g.setColor(Ñ#008000).drawString(`${b.name.padStart(12,Ñ )}:`,a,85+d*25,!0),b.valueŠ¶){£(g.setColor(Ñ#003300).fillRect(a+126,85+d*25,a+226,102+d*25).setColor(Ñ#00FF00),j=getTime(),b.nameŠÑWrite speed){f=E.openFile(Ñtest,Ñw);§(­e=0;e<50;e˜)f.write(c),g.fillRect(a+126,85+d*25,a+126+e*2,102+d*25)}¤£(b.nameŠÑ
Read speed){f=E.openFile(Ñtest,Ñr);§(­e=0;e<50;e˜)l=f.read(c.length),g.fillRect(a+126,85+d*25,a+126+e*2,102+d*25)}j=getTime()-j,f.close(),g.clearRect(a+126,85+d*25,a+226,102+d*25),b.value=(50*c.length/1024/j).toFixed(0),g.drawString(b.value+Ñ +b.units,a+126,85+d*25,!0)}¤g.setColor(Ñ#00FF00).drawString(b.value+Ñ +b.units,a+126,85+d*25,!0);£(b.nameŠÑ	Integrity){­e=E.toUint8Array(l);£(l.lengthŠc.length){b.value=ÑPASS;§(­a=0;a<l.length;a˜)e[a]Œc[a]ž(b.value=ÑFAIL)}¤b.value=ÑFAIL;g.drawString(b.value+Ñ      ,a+126,85+d*25,!0)}¤£(b.nameŠÑFiles){­c=[];ªe(a,b){£(a[0]ŠÑ. b[0]ŠÑ.)«;­d=fs.statSync(a+b);d.dir?fs.readdir(a+b).forEach(e.bind(¶,a+b+Ñ/)):c.push({fn:a+b,l:d.size})}fs.readdir().forEach(e.bind(¶,'')),b.value=c.length,g.drawString(b.value+Ñ      ,a+126,85+d*25,!0)}b.value‹ÑPASS b.value‘b.minžb.valueŽb.max?g.drawString(ÑOK,a+230,85+d*25,!0):(g.setColor(Ñ#FF2200).drawString(ÑFAIL,a+230,85+d*25,!0),k=!1)}),fs.unlink(Ñtest),g.setColor(0,1,0).drawString(Ñ#SD card test completed - press knob,a,56,!0),¸Promise((a,d)¢{ªc(b){b (Pip.removeListener(Ñknob1,c),a(k))}bžk?a(!0):Pip.on(Ñknob1,c)})}}ªm(e){console.log(Ñ
Testing audio),Pip.removežPip.remove(),g.setFontMonofonto18().setFontAlign(-1,-1).clearRect(0,56,479,289).setColor(Ñ#00C000).drawString(Ñ
Audio test,a,56);­f;£(Pip.isSDCardInserted())Pip.audioStart(ÑUI/ALERT.wav);¤{®b=[ÑPREV,ÑNEXT,ÑCOLUMN,ÑOK2];­a=0;f=setInterval(ª(){Pip.audioStartVar(Pip.audioBuiltin(b[a])),a=(a+1)%b.length},500)}­d=!0;­c=100;«e.audio=[{name:ÑSound check,value:¶,units:¶},{name:ÑFM frequency,value:c,units:ÑMHz,min:76,max:108},{name:ÑRSSI,value:0,units:ÑdBuV,min:15,max:100}],¸Promise((h,i)¢{E.showPrompt(ÑSound heard OK?).then(i¢{£(fžclearInterval(f),g.clearRect(0,76,479,289),i){e.audio[0].value=ÑPASS,rd.init(),rd.freqSet(c),rd.setVol(15);ªi(a){£(!a)rd.enable(0),Pip.removeListener(Ñknob1,i),d (b=!1),h(d);¤{c–a*.1,c>rd.end/100ž(c=rd.start/100),c<rd.start/100ž(c=rd.end/100);±{rd.freqSet(c)}catch(a){console.log(ÑError setting frequency:,a)}}}Pip.on(Ñknob1,i),e.audio.forEach((b,c)¢{g.setColor(Ñ#008000).drawString(`${b.name.padStart(12,Ñ )}:`,a,85+c*25,!0)});­f=0;­j=setInterval(ª(){f˜,d=!0,e.audio.forEach((b,e)¢{­h=2;b.nameŠÑFM frequency?b.value=c:b.nameŠÑRSSIž(b.value=rd.getRSSI(),h=0);­i=b.value;b.unitsž(i=`${b.value.toFixed(h)} ${b.units}  `),g.setColor(Ñ#00FF00).setFontMonofonto18().drawString(i,a+126,85+e*25,!0),f>3ž(b.valueŠÑPASS b.value‘b.minžb.valueŽb.max?g.drawString(ÑOK  ,a+230,85+e*25,!0):(g.setColor(Ñ#FF2200).drawString(ÑFAIL,a+230,85+e*25,!0).setColor(Ñ#00FF00),d=!1))}),g.drawString(d?Ñ: PASS - press knob:Ñ                   ,a+90,56,!0)},200);Pip.remove=()¢{clearInterval(j)}}¤rd.enable(0),print(ÑAudio test failed),b=!1,h(!1)})})}ªn(c){console.log(ÑTesting USB),Pip.removežPip.remove(),g.setFontMonofonto18().setFontAlign(-1,-1).clearRect(0,56,479,289).setColor(Ñ#00C000).drawString(ÑUSB test,a,56),c.pass=!1,c.status=ÑConnect USB cable;­d=!1;«¸Promise((e,h)¢{ªa(d){d (Pip.removeListener(Ñknob1,a),c.status=ÑAborted,b=!1,e(c.pass))}Pip.on(Ñknob1,a);­f=setInterval(ª(){!džVUSB_PRESENT.read()ž(d=!0,c.status=ÑWaiting for data),c.passž(Pip.removeListener(Ñknob1,a),e(c.pass)),g.setFontAlign(0,0).drawString(Ñ
          +c.status+Ñ
          ,240,160,!0)},200);Pip.remove=()¢{clearInterval(f)}})}Pip.removežPip.remove(),¾Pip.remove,Pip.removeSubmenužPip.removeSubmenu(),E.showMessage(ÑEntering Factory Test Mode),settings.idleTimeout=0,Pip.kickIdleTimer(),MEAS_ENB.write(0),clearInterval(),Pip.mode=MODE.TEST,Pip.addWatches(),global.ftm={id:Pip.getID(),jsVersion:VERSION,fwVersion:process.env.VERSION};­a=60;LCD_BL.write(1);­c=¸Uint8Array(4096);c.forEach((b,a)¢c[a]=a%256);­b=!1;rd.init()žrd.enable(0),ftm.tests=[{name:ÑInputs,fn:i},{name:Ñ
LEDs & pixels,fn:j},{name:ÑMeasurements,fn:k},{name:ÑSD card,fn:l},{name:ÑAudio,fn:m},{name:ÑUSB,fn:n}];­f={'':{x2:200},Ñ[ Run all tests ]:ª(){b=!0,ftm.currentTest=0,e()}};­h=()¢{Pip.removežPip.remove(),¾Pip.remove,g.clear(1).setFontMonofonto23().setColor(0,1,0).drawString(ÑPip-Boy Factory Test Mode,a,20),g.setColor(0,.6,0).drawLine(0,52,479,52).drawLine(0,290,479,290),g.setFontMonofonto16().drawString(`Version ${ftm.jsVersion} ${ftm.fwVersion}     ID:${ftm.id}`,a,295)};­d=()¢{h(),E.showMenu(f),bC.setFontMonofonto18().setColor(3),ftm.currentTest=¶,ftm.tests.forEach((a,b)¢{a.fnžbC.drawString(a.pass‹!0?ÑPASS:a.pass‹!1?ÑFAIL!:'',212,43+b*27)}),ftm.tests.every(a¢a.pass‹!0)žbC.fillPolyAA([290,100,310,120,355,65,375,85,310,145,275,120]);­a=setInterval(ª(){bC.flip()},50);Pip.remove=()¢{clearInterval(a)}};ftm.tests.forEach((a,b)¢{f[a.name]=ª(){Pip.removeSubmenužPip.removeSubmenu(),ftm.currentTest=b,a.testTime=Date().toLocalISOString();­c=getTime();a.fn(a).then(b¢{a.testDuration=Math.round(getTime()-c),a.pass=b,d()})}}),d()}®VERSION=Ñ1.29;®MIN_FW_VER=Ñ2v25.280;¬fs=require(Ñfs);log(`------- Booting ${process.env.VERSION} - ${VERSION} -------`),log(ÑReset flags: 0x+(peek32(1073887348)’24).toString(16).padStart(2,Ñ0)),poke32(1073887348,16777216),clearTimeout(),g.theme.fgŠ65535žg.setTheme({fg:2016,fg2:2016}),process.on(ÑuncaughtException,ª(a){£(Pip.sleeping)console.log(Ñ#Uncaught exception while sleeping: +a);¤±{clearTimeout(),clearWatch(),Pip.sleeping=!1,B15.set();­b=global.__FILE__?`(${global.__FILE__}) : `:'';b–a?`${a.type}: ${a.message} `:Ñ
Unknown Error,Pip.isSDCardInserted() (b–Ñ
(No SD card)),g.clearRect(120,90,360,180).setColor(g.theme.fg).drawRect(120,90,360,180),g.setFontMonofonto16().setFontAlign(0,0),g.drawString(g.wrapString(b,220).join(Ñ
),240,138,1),g.setFont(Ñ6x8).drawString(`ID:${Pip.getID()} V${VERSION} ${process.env.VERSION}`,240,96,!0),aža.stackž(b–a.stack),log(b),setWatch(a¢{LCD_BL.write(0),setTimeout(Pip.off,1e3)},BTN_POWER),E.getConsole()ŒÑUSBžsetTimeout(Pip.off,3e4)}catch(b){console.log(Ñ%Error in uncaught exception handler: +b.message+Ñ
+b.stack),console.log(ÑOriginal error: +a+Ñ
+a.stack)}});®LED_RED=LED1;®LED_GREEN=LED2;®LED_BLUE=LED3;®LED_TUNING=LED4;®BTN_PLAY=BTN1;®BTN_TUNEUP=BTN2;®BTN_TUNEDOWN=BTN3;®BTN_TORCH=BTN4;®KNOB2_A=BTN5;®KNOB2_B=BTN6;®KNOB1_BTN=BTN7;®KNOB1_A=BTN8;®KNOB1_B=BTN9;®BTN_POWER=BTN10;®MEAS_ENB=C4;®LCD_BL=B15;®VUSB_PRESENT=A9;®VUSB_MEAS=A5;®VBAT_MEAS=A6;®CHARGE_STAT=C5;®RADIO_AUDIO=A4;®MODE_SELECTOR=A7;®SDCARD_DETECT=A15;pinMode(MEAS_ENB,Ñ	opendrain),Pip.isSDCardInserted=()¢!SDCARD_DETECT.read();¬settings={};Pip.isSDCardInserted()?fs.statSync(Ñ
settings.json)ž(settings=JSON.parse(fs.readFile(Ñ
settings.json))):log(Ñ Can't load settings - no SD card),isFinite(settings.idleTimeout) (settings.idleTimeout=3e5),settings.timezonežE.setTimeZone(settings.timezone),(¿settings.alarm)[0]ŒÑož(settings.alarm={time:¶,enabled:!1,repeat:!1,soundIndex:0}),settings.alarm.snooze (settings.alarm.snooze=10),settings.alarm.soundFiles=[];±{settings.alarm.soundFiles=fs.readdirSync(ÑALARM).filter(a¢a.toUpperCase().endsWith(ÑWAV)ž!a.startsWith(Ñ.)),settings.alarm.soundIndex>settings.alarm.soundFiles.lengthž(settings.alarm.soundIndex=0)}catch(a){log(ÑNo alarm sounds found)}Pip.setDateAndTime=a¢{console.log(ÑSetting date/time to,a),settings.century=Math.floor(a.getFullYear()/100),a.setFullYear(a.getFullYear()%100+2e3),setTime(a.getTime()/1e3),saveSettings()},Pip.getDateAndTime=()¢{­a=¸Date;«a.setFullYear((settings.century 20)*100+a.getFullYear()%100),a},MEAS_ENB.write(0);±{Pip.setDACMode(Ñout)}catch(a){log(ÑsetDACMode error: +a)}Date().getFullYear()Š2e3žsetTime(¸Date(Ñ2077-10-23T09:47).getTime()/1e3),Number.prototype.twoDigit=ª(){«¯.toString().padStart(2,Ñ0)};­dc=require(Ñ
heatshrink).decompress;­icons={cog:ÑGŒF UPUÿ(*Íã¥ƒoßþ¾ Pwÿÿÿô
=¼
D)øÅV¯ÿüßÿùP(?Zÿÿª"tQHÃ³/äÐË!H  ,holotape:ÑIŒF UPÕ¿ø ,­|
ÖÞýV‡üªím÷ÿÿæ«u·KÀ¡„Bþ„BÕª×ŠDŠôð
	4O-WT ì½T,alarm:ÑE‡Ä P)p_ÿ ß€Á~ùƒô€Áè_À`Ð@@ÿ``0~ð> ?ÿx_ôV}ñ¨@/ô ,noAlarm:ÑD‡Ä P)p_ÿ €Â—€Á Á€x'ÿÈ8¤¡ ‡Aÿð7°0; à^/øx8¬ûâ8ÿ@€ ,charging:Ñ4…D Pÿþÿðÿ`_þÿéÿ@/ýZßü ?ÿôˆƒð _Húà@&8´ ,snooze:ÑP V¯  ÿÿÀ ?ÿð Aô   ü   }” ? ÿü@ÿÀ GÐ ƒð ôÀÿÿÇÐÿóÐêVõ   ÿü  ¿   };­bC=Graphics.createArrayBuffer(400,210,2,{msb:!0,buffer:E.toArrayBuffer(E.memoryArea(268468224,21e3))});bC.flip=a¢Pip.blitImage(bC,40,65,{height:a});­bH=Graphics.createArrayBuffer(370,51,4,{msb:!0,buffer:E.toArrayBuffer(E.memoryArea(268489224,9435))});bH.flip=()¢Pip.blitImage(bH,53,7,{noScanEffect:!0});­bF=Graphics.createArrayBuffer(372,25,2,{msb:!0,buffer:E.toArrayBuffer(E.memoryArea(268498659,2325))});bF.flip=()¢Pip.blitImage(bF,52,290,{noScanEffect:!0});­BGRECT={x:36,y:58,w:408,h:230};®modes=[ÑSTAT,ÑINV,ÑDATA,ÑMAP,ÑRADIO];®MODE={TEST:0,STAT:1,INV:2,DATA:3,MAP:4,RADIO:5};­MODEINFO;­sm0,d0,tm0,ts0;settings.fallbackMode‹·ž(settings.fallbackMode=MODE.RADIO),Pip.measurePin=(c,a,d)¢{d‹·ž(d=2),a‹·ž(a=10),MEAS_ENB.write(0),pinMode(c,Ñanalog);­b=0,e=0;§(­f=0;f<a;f˜)b–analogRead(c)/a,e–E.getAnalogVRef()/a;«pinMode(c,Ñinput),bšd*e,b},Pip.getID=()¢{­b=peek32(536836624);­d=peek32(536836632);­c=peek32(536836628);­a='';§(­e=0;e<4;e˜)a–String.fromCharCode(d’24-e*8&255);§(­e=0;e<3;e˜)a–String.fromCharCode(c’24-e*8&255);«a–Ñ-+(c&255).toString(16).padStart(2,Ñ0),a–Ñ-+((b&16711680)’16).toString(16).padStart(2,Ñ0)+(b&255).toString(16).padStart(2,Ñ0),a},Pip.knob1Click=a¢{a>0?Pip.audioStart(ÑUI/ROT_V_1.wav):Pip.audioStart(ÑUI/ROT_V_2.wav)},Pip.knob2Click=a¢{a>0?Pip.audioStartVar(Pip.audioBuiltin(ÑPREV)):Pip.audioStartVar(Pip.audioBuiltin(ÑNEXT))},Pip.typeText=i¢{­g=[ÒÐW O I ÉÿÒþÇþr AmÿÂýÿ÷ y ´þ&þ÷ üoHÿþíÿÛÄ ÿWþWÿy¢y Ëþ4þ…ÿ\  ÖÿÀþˆÿ•B Äþ‡þ ã Q ÂÿüþCKÿoÿu «VÈþÉÿõ ¤ ƒ þýÿgÿoÿðýëÿ<ÿH-qþ§ ýöýç™ =û/ö5—/ýâûJùOÿy‡ÿ¡ø$ Dýƒýü2–ÿ›úfX¡ÿò¥þþŠÿi ÈwGþ:ý;ÿ)Õ ÿ™ÿyüüa]þõ¾ýHXþÂûýõŠpþzÿíöÈõý4
²÷öùòÿö™þYíÞ#š÷ ÿîó·í»Äóïñâð M§öôuè÷òþU
ðöèïE
> — ~
÷õ½÷L„ÿ%å€ò¢øWþ-Y•õöð¹ù³'‹ð2ö‰š
]ûAó8úw	+
³û8ô€ûvk	
ü5üû[ü"æ+þLùDúU	äÿ©ú¦ýþS Wÿÿù³ù ¿ßÏüüT ºi {ÿBþ
þÞã zûú©­9zûPü"ÛIþGþ<ý•þ°ñïÿz÷€÷ÊõROý@ûØýñ7š–1û‚ú¼ýËõýeùÊü8óçýgúÚýrÄ¿JÿÆûýüãÿÆIÿ;ü.þï-üwý1¦| bþLþ@þ( U" zþ ¨Å Âý%ýC  V’ çýÑþN½ÿLüÁþ©y^ÿ ýWýƒ i“ 7 âþâü™ÿ!K4‘ÿ£ýYþõÿI þêüGÿ¬ìýÅýŒ x   ,ÒVt E ÿ4 }ÿÓÿü ÈÿÎÿäÿTÿ F šþy = B Á eþÿDÇÿ¼ æÿHþ ¥ [Í Ïýþo ñ’ÔþºþŽþ×ÿ]† •þ!ÿýÁ2,ÿ©ÿÿýþb Æ W«þŠþýš1 Kþ.ý9þG`ßþy øû v‡þž Ñÿ5ü’ þªŠýwý{ þèþ€ãüŽzúW· Áý]ÒÿüÔüeQžý)þ™þü8¤þÖýÄú¨ý>ý vüç÷“ýß9ú&ø²þ™Î‹Vú£÷ƒþ)—a¹ùb÷¶þ¢¦úÑ÷Pþ=©½ú	øþNõ1÷ú*ù{þ$‹³ûÌùyþ½µ„üúûÿ¿ÿ‚åþäý_þñÿ=Øqÿzþ§þQ >‡ & ñÿ ÿÿ Â u Mÿ=ÿ;ÿdÿ¾ ìBÿƒýÒý ¨.àý—üäþ½Ir ²ý¥üÿÝQ |ýµü\ÿ½„N `þŽýeÿw÷ ïþ±ýñþ<êTÿ«ýðþÞ èp`ÿ•ýËþÇ ‹þþûÿé ®ÿÿÀÿœ ~ ãÿvÿËÿe  Õÿ/ÿ»ÿ± é ìÿÿPÿ9 Ë ‰ ÛÿRÿÍÿ  ;   òÿÆÿ¯ÿúÿn | îÿTÿŒÿ= Ø z uÿÿ¼ÿß í Ûÿ	ÿtÿn ª  ¹ÿµÿÞÿ,ÒºÁ Ø * [ ]+EÛ %” =ñÿHþÿþX õÿ¼þþÄÿ²þ1üžýüýüþ(DýÇþÕ• 8èþ§úøüÊû*ÿü$ûõ¾÷
JÿñÃþþöÏFrúÆŒùð 6ÿJû'G“ìZ8cÍíÑ÷ÐA÷IÂõ¹»ùï7
–ýC Øôá[÷Ý÷{ýr
%ù¸÷wÿûb
¸ü;üå÷‰ûOÞWüRööÑyû£÷«ýƒ6Ùÿú˜úüüÉç+ °úµö,ý—	©
åxøÉöÄ@w	ýßóTûæ„
+…ö"÷EÿD`™ÿœ÷qõÆüzpº ´öçö	
¯:ÿø‡ûŸõ	ÿLüwùòü9Ç³¶þÿ÷6ùê ŠÁ½úùMþ„ëDÿ¨øûNîîý¡ühþt%þ#ü•üuÿph-ûeú€ÿX<Ëÿ…ýþ1 Äòê Ëþþhÿ>„š ›úžû0¶ÿ ýýKÿ++Á œý©ü8ÿ0Î4"þ$þóÿÛ V ØýàýÑþÿ]ÿ¶ÿ¡þÑý_ÿ™ Ç¡ˆÿÙþbã>î •ÿ“ vYí  þ•þ?  Fÿÿƒþœýþyþ¿þ¿ÿ«ýÚýWÜ »ÿï ¯Ñß Wÿ^  pÿ¦þ q
ÿùü‡ÿ:e {ýdý0 —t4ÿÿ9· ÿ!ÿÀ Åÿ J UÿXÿÃÿÿ =þ ýõþ… óÿeÿ‘ÿ# & ˆÿ( | Z Í +ÿs  Ûÿ "+! ÌÿVÿ·þ;ÿÿßÿj úÿ(  úÿ ï ,ÒüŸ «èÂm ðÿypÿìþrÿjÿÆþ8ÿ_ÿÓýëþSŸ ¼ÿtÿ ‚pr Lÿq fPÿ•þ‚ÿWYÿGÿL 6öþþš ñÿ;ÿe cÿèÿS ¾ÿ)“ àÿO]þ]þ ¨ýÕüˆý}sLÿKÿê †v *þD ªþáüI :þªüÓ ò\ÿUý†ýÃÿ$ þ±þ–þÎ „ð  þÓûõ ßŠµþÍümýs—Xú,ÿ"ûôä	ÝùÁûÞÿ
üÚü ï=+¢	¡ºékú·
##ðîð£
ÃüùCöyJjÿTûþôÿÑéùTþ‡wžø¯ó)¼s)ûïKø7
’a‹ô¾ô©7C¢üGùÿöïþ- uƒ6ýBý¯S•ýú¤ù@þœÒ‹ü—÷‚ú÷	þ¬üøãúÃ6+nÿ‘÷töWÿ‘
;
Iõ-ò¡ý{
d-ó€ð+ý?
~
YyõŠôíý 	2Íú@öŒù&
þ
õöKB	Y bøÄøÿ"[	$:üøôû»³qFþÒøúJÿ¹û‘'û7ø3ý-ŒLü¦ùVüÒ*ÿúÊúCqµ  úê÷Vü•þŸ9ú&ùyþÚÞìüÔú½þùÃêþü6ý$ôÿ‚üÍüÿæÆoÿ¼ûMüùþd< ;þÃþg vÆÇHœþLþ*ÿ¬ lƒ UýGýÉÿúÿžþÙþ–þ< Ã g µ™ #ÿÿø\Š 
þÍþ: N Ëþ”ýåüùýH ‘°lþ{ýóÿ¶—O ôÿ k «ÿŽ "ÿ¢üiþ$TæýhûïýEÿJþI ¯JÞ Ô Ú
 Òþ‡ÿ];­a=0,b=0;Pip.typeTimeržclearTimeout(Pip.typeTimer);­h=0;­d=0;­f=i.split(/\x20|\xa0|\x09/);­e=f[0];bC.setFontMonofonto16().setFontAlign(-1,-1).setColor(3);®c=bC.getFontHeight();«bŠ0ž(bC.clear(),drawVaultTecLogo(199,15,bC),b=125),¸Promise(j¢{ªi(){£(dŠ0ža+bC.stringWidth(e)>359ž(a=0,b–c),b>bC.getHeight()-cž(bC.scroll(0,-c),b—c),d<e.length){­f=e[d˜];bC.drawString(f,a+20,b),bC.flip(),Pip.audioStartVar(g[Math.random()*g.length|0]),a–bC.stringWidth(f),(fŠÑ
 a>bC.getWidth()-6)ž(a=0,b–c)}¤{£(d=0,až(a–8),!(˜h<f.length)){Pip.typeTimeržclearTimeout(Pip.typeTimer),Pip.typeTimer=0,j();«}e=f[h]}Pip.typeTimer=setTimeout(i,Math.random()*50|0)}i()})};­alarmTimeout;configureAlarm(),Pip.offAnimation=ª(){¬a=(E.toFlatString E.toString)(Ò 0µOðÀD*##€K "$%€€%€»%€+%%€Àó%€Å²€Áó%€Í²€	,%OôÌpû %€FŠBÚ€2úç0½  `ðµOðÀF*#3€;K $$'€€'€»'€+'7€EÀó'À²€€Åó €í². €0€ˆ­òlm€²­ø ¯ Fˆ'ø@0°õÌøÑOöê &ôübˆ7øP¤²$ôül%ôü``DpDôüeôüd,DÅH¿@ôx@D…H¿@ð %H¿Dôüdôüd ôü` C'ø 6¶õÌØÑOðÀ@*"€$$ "€€$€»$€+$€Áó$É²€€€€,!€7ø€2²õÌøÑ
òlmð½ ¿  `øµP$FAž& %¥BÚ50F:FÅñ ÿ÷sÿÆõŸp:FñŸÿ÷lÿ>íçe Äñ Åñ  ÿ÷9ÿñ ñ  ½èø@ÿ÷1¿  ),b=E.nativeCall(337,Ñ
void(int,int),a);«¸Promise(e¢{¬a=0,c=((g.theme.fg&63488)>16384?2048:0)|((g.theme.fg&2016)>512?32:0)|((g.theme.fg&31)>8?1:0),d=setInterval(ª(){£(a<7)b(a,c);¤{analogWrite(LCD_BL,1-(a-8)/8,{freq:200});¬f=200-(a-7)*20,h=f+25;f<0?(LCD_BL.write(0),clearInterval(d),e()):g.clearRect(240-h,155,240-f,165).clearRect(240+f,155,240+h,165)}a˜},50)})},Pip.offOrSleep=ª(a){a=a {},Pip.idleTimer=·,Pip.sleeping=ÑBUSY,Pip.removežPip.remove(),Pip.removeSubmenužPip.removeSubmenu(),¾Pip.remove,¾Pip.removeSubmenu,Pip.radioOnžrd.enable(!1,!0);­b=()¢{Pip.audioStart(ÑUI/POWER_OFF.wav);­b=[LED_RED,LED_GREEN];Pip.radioOnžb.push(LED_TUNING),Pip.fadeOff(b),Pip.offAnimation().then(b¢{MEAS_ENB.write(1),setTimeout(b¢{Pip.sleeping=!0;±{clearWatch(),setWatch(Pip.powerButtonHandler,BTN_POWER,{repeat:!0}),a.forceOff?(console.log(Ñ"forceOff => turning off completely),Pip.off()):Pip.sleep()}catch(a){log(ÑError going to sleep: +a)}},1e3)})};a.immediate?b():Pip.fadeOff().then(h¢{g.setBgColor(0).clearRect(36,40,444,288);­c=Graphics.createArrayBuffer(260,35,4,{msb:!0});­a=15,d=-1;bC.clear().setFontMonofonto28().setFontAlign(0,-1).setColor(3).drawString(ÑPIP-BOY 3000 Mk V,200,10);­e=settings.userName?ÑAssigned to +settings.userName:ÑSerial number +Pip.getID();bC.setFontMonofonto18().drawString(e.toUpperCase(),200,60),c.setFontMonofonto36().setFontAlign(0,-1);­f=setInterval(b¢{c.setColor(a).drawString(Ñ- SLEEP MODE -,130,-3),bC.flip(100),Pip.blitImage(c,110,180),a–d,(aŠ15 aŠ6)ž(d=-d)},100);Pip.audioStart(Ñ
UI/BURST5.wav),Pip.fadeOn([LCD_BL]),setTimeout(a¢{clearInterval(f),b()},3750)})},Pip.offButtonHandler=()¢{£(BTN_POWER.read()){­a=setWatch(a¢{clearTimeout(b),settings.longPressToWakež(settings.longPressToWake=!1,saveSettings()),Pip.offOrSleep({immediate:!0})},BTN_POWER,{edge:Ñfalling});­b=setTimeout(b¢{£(clearWatch(a),BTN_TORCH.read())«;settings.longPressToWake=!0,settings.alarm.enabled=!1,saveSettings(),configureAlarm(),Pip.removežPip.remove(),Pip.removeSubmenužPip.removeSubmenu(),Pip.audioStart(Ñ
UI/BURST5.wav),E.showMessage(ÑPip-Boy powering off),setWatch(a¢setTimeout(a¢Pip.offOrSleep({immediate:!0}),1e3),BTN_POWER,{edge:Ñfalling})},2500)}¤Pip.offOrSleep({immediate:!0})},Pip.idleTimer=·,Pip.kickIdleTimer=ª(){Pip.idleTimeržclearTimeout(Pip.idleTimer),Pip.idleTimer=settings.idleTimeoutž!VUSB_PRESENT.read()?setTimeout(Pip.offOrSleep,settings.idleTimeout):·},Pip.kickIdleTimer(),Pip.brightness=20,Pip.sleeping=!1,Pip.demoMode=0,Pip.fadeOff=(b,c)¢{Pip.fadeTimerž(clearInterval(Pip.fadeTimer),c=Pip.tempB),cŠ¶ž(c=Math.pow(2,Pip.brightness/2)/1024),bŠ¶ž(b=[LCD_BL]);­a=c;«¸Promise(d¢{­c=ª(){clearInterval(Pip.fadeTimer),b.forEach(a¢a.reset()),¾Pip.fadeTimer,¾Pip.tempB,d()};Pip.fadeTimer=setInterval(()¢{£(aš.65,a<.01)«c();b.forEach(b¢analogWrite(b,bŠLED_GREEN?a/2:a,{soft:bŠE3 bŠE4,freq:200})),Pip.tempB=a},40)})},Pip.fadeOn=(b,c)¢{Pip.fadeTimeržclearInterval(Pip.fadeTimer),cŠ¶ž(c=Math.pow(2,Pip.brightness/2)/1024),bŠ¶ž(b=[LCD_BL,LED_RED,LED_GREEN],Pip.radioOnžb.push(LED_TUNING));­a=Pip.tempB .01;«¸Promise(e¢{­d=ª(){clearInterval(Pip.fadeTimer),b.forEach(a¢analogWrite(a,aŠLED_GREEN?c/2:c,{soft:aŠE3 aŠE4,freq:200})),¾Pip.fadeTimer,¾Pip.tempB,e()};Pip.fadeTimer=setInterval(()¢{£(aš1.46,a‘c)«d();b.forEach(b¢analogWrite(b,bŠLED_GREEN?a/2:a,{soft:bŠE3 bŠE4,freq:200})),Pip.tempB=a},40)})},Pip.updateBrightness=()¢{­a=Math.pow(2,Pip.brightness/2)/1024;analogWrite(LCD_BL,a),analogWrite(LED_RED,a,{soft:!0}),analogWrite(LED_GREEN,a/2),Pip.radioOnžanalogWrite(LED_TUNING,a,{soft:!0})},Pip.powerButtonHandler=()¢{£(Pip.sleepingŠÑBUSY)«;Pip.sleeping?checkBatteryAndSleep() (Pip.kickIdleTimer(),settings.longPressToWake?wakeOnLongPress():(wakeFromSleep(showMainMenu),Pip.audioStart(ÑBOOT/BOOT_DONE.wav))):(Pip.idleTimeržclearTimeout(Pip.idleTimer),Pip.offButtonHandler())},Pip.usbConnectHandler=a¢{£(console.log(`USB ${a.state?'':Ñdis}connected`),Pip.sleepingŠÑBUSY)«;Pip.kickIdleTimer(),Pip.sleeping?a.statež(console.log(ÑUSB connected - waking up),settings.longPressToWake?(settings.longPressToWake=!1,saveSettings(),wakeFromSleep(playBootAnimation)):wakeFromSleep(showMainMenu)):drawFooter()},Pip.addWatches=()¢{clearWatch(),pinMode(KNOB1_B,Ñinput),setWatch(a¢{­b=a.state^a.data?-1:1;Pip.emit(Ñknob1,b),Pip.kickIdleTimer()},KNOB1_A,{data:KNOB1_B,edge:1,repeat:!0,debounce:0}),setWatch(a¢{Pip.emit(Ñknob1,0),Pip.kickIdleTimer()},KNOB1_BTN,{repeat:!0,edge:Ñrising,debounce:20}),Pip.modeŠMODE.TEST?setWatch(E.reboot,BTN_POWER,{repeat:!0}):(pinMode(KNOB2_A,Ñinput),setWatch(a¢{­b=a.state^a.data?1:-1;Pip.emit(Ñknob2,b),Pip.kickIdleTimer()},KNOB2_B,{data:KNOB2_A,edge:1,repeat:!0,debounce:0}),setWatch(a¢{Pip.emit(Ñtorch)},BTN_TORCH,{repeat:!0,edge:1,debounce:50}),setWatch(Pip.usbConnectHandler,VUSB_PRESENT,{repeat:!0}),setWatch(Pip.powerButtonHandler,BTN_POWER,{repeat:!0}))};­showTorch=()¢{£(Pip.sleeping)«;Pip.removežPip.remove();ªa(){Pip.removeAllListeners(Ñtorch),Pip.audioStart(ÑUI/L_OFF.wav),Pip.fadeOff([LCD_BL],1).then(a¢{g.clear(),showMainMenu(),Pip.fadeOn([LCD_BL])})}ªb(b){b a()}Pip.fadeOff().then(c¢{Pip.audioStart(ÑUI/L_ON.wav),g.setColor(g.blendColor(g.theme.fg,Ñ#FFF,.2)).fillRect(0,0,479,319),Pip.fadeOn([LCD_BL],1).then(c¢{Pip.on(Ñtorch,a),Pip.on(Ñknob1,b),Pip.remove=ª(){Pip.removeAllListeners(Ñtorch),Pip.removeListener(Ñknob1,b)}})})};­torchButtonHandler=()¢{£(BTN_TORCH.read()){­a=setWatch(a¢{clearTimeout(b),showTorch()},BTN_TORCH,{edge:Ñfalling});­b=setTimeout(b¢{£(clearWatch(a),BTN_POWER.read())«;£(BTN_PLAY.read()žKNOB1_BTN.read())console.log(ÑDTorch, play and knob1 buttons held down - entering Factory Test Mode),Pip.removežPip.remove(),Pip.removeSubmenužPip.removeSubmenu(),Pip.videoStop(),factoryTestMode();¤{­a=1;­b=setInterval(d¢{®b=[2,10,20];­c=b.findIndex(a¢a‘Pip.brightness);c‘b.length-1ž(a=-1),cŠ0ž(a=1),Pip.brightness=b[c+a],Pip.updateBrightness()},1e3);ªc(){bžclearInterval(b),b=·}setWatch(c,BTN_POWER,{edge:Ñrising}),setWatch(c,BTN_TORCH,{edge:Ñfalling})}},1e3)}¤showTorch()};­drawVaultTecLogo=(b,c,a)¢{a (a=g);­d=Ò–½L @ó :ÿþZÌþ úbÿþ³ä.ƒ¿®Y 
^Z<Ð<®ü:$Ð©/Õ¨”b±uP 5²˜-PŽàÀ¿ÀÀªŒä ¼Å°,  	tø\xxèÿ*ZÀ·jø¶¿ð°6üÀO	øƒðH‡±ÃŸÐ#á7àpVáïÇ„ßÁáAü2p0oÑœ  \BIõjµHwË¿À0|Ð4ùä¥°œÿ x3öª_HÐˆ	ÔÂ€0  !Ò€ÏÏà Cô!äPS€
eŒF
ù0  kyÔ0 G J`£‚'ÿ^‚
ÀS¼ü ([ð˜æPA#ÿ`?‡°!à·# !1ÿôµèð~„~}‰/ˆüp 5öô‚
ü pcÃ@â€ßßüƒÂ"ï`CÂ ;þŠ‡ˆ8°²õ±?H$w˜P? À (/2 ðmZ  š¶X.x àgô?àº¬‚p°K `åHBPL€‰B AWô)ƒþ­Aþ€”nÌ_€ÿ«ú úH0ñJpÆ Ž—‰ƒÁàê;à#€!p`öØ"@·¤àÏ¤ÃÉ¦—„AŠÐ ààá‡ï 	À	Ô8Qÿ„X,¶Lœ	.„J-
ü$8 hú$2`0°ð@0¡àÑ	€W·J—^j"ø©Q¶8¢PÂÀ‚ÃÿÊ %,ýžH ¦8# ªpÃ©ªAZ†· ¤= `2ðÀgÀRH6ÈÒÕZ ³‹ ov 5ô±ÁUZ @Ð;­e=Òc¬Äà[þ¿åÿ€_ø_é‡ÿÿà@ `õÿÿÿŸø‡ÿ Ëþþó~?ÿþ¿ÿÈÿçÿÿ§ÿH_ò~^ÿÿƒ€…Aÿ¯ÿ€àŒBå€@À`ëÿü 1ÿ†üÃÿÏþ:ÿö þÐþ˜2 #À~  ‚7ø	€p?ÿô° (  0’ÀÏÂ Ëþaø"À`Ð~?ÿÀD¨#`F`ÿ¡,ð‚€-0Ì Ø?á``ø!ÐS.Bñ¥–G°Ø(ÿÄXU¨,úÇ–‚Nù,

°Ì%È3ÿñ8P+~ 4ð¨<?öü°õb0@!¨'€• €„j„:b€è#pQ@³B_„X@|b?ðå^ö¿°ú˜¨d#Zÿâ—Õ@Õª€A¿ ;a.drawImage(dc(d),b-61,c),a.drawImage(dc(e),b-45,c+60)};­drawVaultNumLogo=(b,c,d,a)¢{a (a=g);­e=Ò*ÿXàA÷ ºÿÿû(^æßÿ @íˆ È>Ö>ÿøiÿü³ˆÿÿW¯õ?Ê>/ÿô_ÿðïßÍà®ŸÿÐÖÇÇÇGÖÁÇÇþƒë #ãÿýý—ñúëƒå ïßÙ@ÆbþAaÂßÔÆ–&Œ…
ô¼èðEÿ ¦X?? >¶?Ë›üþ*%d°wà|£‘©ødßò>€h§ôp1¿@Ó?òŽ3_… ‡†Œþ”_ü(4zõGÊ# A£:åD†(…†‹ð•š½2?Dä1zd'üûX L=z€I0Q8	„VÌ€
uô	)>˜Vœ|$À2©2tô°±P_Àš_ƒôÆ ø	$‚g€‡š’¤’?6é>~ -R
¿† ;à$:#Kÿè‡§ÿ2'þ/ÿð4“§. 6&Sû ƒ…Ô?Mÿü@‚ê•Á?IÿøoÂêðÒÿùáe‡é¿Çï¸oß~u¼éLÀËÚªŸ¦ @/áu>ép€Gê—€FÑÀ„‰þL‡ªI	Ÿ?	…Ð* >*ð:ø>”ü' &uü&hY© ˜i#Àšƒð$’ ¥t‡ÿ		ð?M?…ô)B ^+€Ñ„ ¼<Vô% -ùà0 ®£R" ÈW€‰
ÿàFOÃ%1W«6/ ¼…|rô° <òª"×Ç_ÃFPÊGÄfƒEÃÃF6M ™ÿú¥^¯ÿèŠš¾V$9üQdïùHX×ñQðÉ¿Áò	x•rÁßñò°ø”ß \x]›ñú°!ôÇóüë mP ]yü±ðÞ ØÚQë ]ã~AaÂÙf€$ªFÒ@ ;ðH¿ÑõpûÄà 4õpòõqñïËÄ€~Z ~üì ü|o }t|o€}t>3è>¾ø`?0}ü¿èû!ù_‘öcòW™€†òµ o‡þ ·€AuãÐr‚'@;­f=Ò•J [ÿø ô 
â…ÿøÂ	üÀ€ èúH'€@$,ð('Ð°? ”€P ò P1À'0ÂßÀa jx ‚0PÁ-€f8@()€K €%Üˆ(üJ´.€$ ! M.‹ˆx\!˜e€Çá,†ø8XàBp^ AIÀžcXP2'pÇÁt JÁÊ`ˆ@ƒÀC-Ö	²
0/ÿlt ê˜$h" ‚‚–A†€Ë()H  Æ0J@„ä€@µ@ µ ;­h=Ò•J _ð _èx0 ž IÀ ð t  €   €@ÿ°q xÈ6«_ÿú@-Z P8	t °?  3ÿÿ@	”ð9 @ðx @CÂBÅÁ@#ä AAÃƒü„\Œ0<1#€ ñ g ÊAÂ9æ”èb@ƒA)æL#ÀDVà‘%/%5¾¼8ü8xCPB¨Ä^
 @ §@‚„ŠE‚)† <î@°Ø? ~¾,üH„} x0@ð!ˆƒ$»ÿø
	À¶<P50!@ƒ"A@›5ú_‚\_è;a.drawImage(dc(e),b-127,c),dŠ32?a.drawImage(dc(f),b-21,c+30):dŠ33ža.drawImage(dc(h),b-21,c+30)};­drawText=(c,d,e,a)¢{a (a=g);­b=c.split(Ñ
);a.setFontMonofonto23().setFontAlign(0,-1),b.forEach((b,c)¢{a.drawString(b,d,e+c*30)})};­showVaultAssignment=()¢{­a=32+Math.floor(Math.random()*2);­c=settings.userName?settings.userName.toUpperCase():ÑCONSTITUENT;¬b=0;g.clearRect(40,40,440,58);­d=()¢{¬d;bC.clear(1).setFontMonofonto23().setFontAlign(0,0),bŠ0?(d=aŠ32?Ñ%WE BID YOU FAREWELL!
YOU'RE MOVING TO:Ñ"CONGRATULATIONS!
YOU'RE STAYING IN,drawText(d,200,15,bC),drawVaultNumLogo(200,85,a,bC)):(aŠ32?d=ÑCONGRATULATIONS,
+c+ÑB!

YOU'RE ONE OF THE CHOSEN
PIONEERS WHO WILL
REPOPULATE VAULT 32!:d=ÑCONGRATULATIONS,
+c+Ñ6!

YOU REMAIN A
TRUE AND TRUSTED
RESIDENT OF VAULT 33!,drawText(d,200,15,bC)),b=(b+1)%2};d();­e=setInterval(ª(){bC.flip()},50);­f=setInterval(d,3e3);Pip.removeSubmenu=ª(){clearTimeout(f),clearInterval(e)},setTimeout(a¢Pip.audioStart(ÑUI/ALERT.wav),100)};Pip.clockVertical=!1;­submenuClock=()¢{tm0=¶;­b=ÒŒ±ëàAgÂ… ðÂÓÿý .¤ÿÿÈ“ÈGÃ ÿC	_ÂÀ€£ˆC ß…ÄÿÎ…Ð!cŠsò!PÆ
…ïÿàÀÿÿÿÿ_Ñ¾ÄøxDþ
¢ãÿóþŒ†À¶Îzý@ügÒGús Ÿá€lPçî€@î AqF`ïè
Ã>ŸÓ°_àÀ]ðÀÈ^.€À
–­69~Õ…ø¿¥
‘—ÄÀ€£ÿÏf¤…ñž‚ÿ±NIŽK.dü) %¡ `Éz<ê°?ô¡ 	$Úÿ¶Áb£øI7ùÿOÿð0¸>é²°ÙÒñÿ‡Š¹à	&ýÿôÿÿÂþ˜C	~L
ïnŸ‡V	ÓÊ·M!ƒø=ù@2 ýÛˆ…„Á†úûI&ËÂ@·Á ónšbþÂ  Äx .ø6é°ðL1˜„“aüp_„_ÿè`Ùìê¦(à7i¹¢Ô#ÄÐG³þ NÁQö…t~a€¼ƒK€Á¿úú´-@\Ø}z¸As ÿÿæ¶õD ÿÿª‡üŸ ßÿ`a€ú„`«ƒUÆ\Á0À¦` À‹F*ý" ¹ño `?]/À:ßïú1Áz…?õ0Îÿ÷ÿðÀX?þ½,c +ÿòé/ÿ_ÿrˆ·á `ßçÐ?PH!reëðËÀÀ¿T<°P)r!hàÿ?ÿè$(?éûì–À¤ ù[x€(%€êPÂ"€‡¹$
	0x&Xq !qUþÁÁA†† ù€	ü†¸ 2ô(?ÇØa“¡ òû_¼0HÀ‘pa‚Fûà Z"†ÿ×“
•ÿT‚LŽ
tSÙ±°n°à1Ëa‹‚2„ààÿ  öA”_èoÁD@¨Žx!qÈ!?À ca bÈà~b2E¡{Ž$˜	1àA€²Ñb
á¯G~ ‡‚=‰ûþËÁA9b"/Â#0)ˆsØcÐÿŽ@ÿÁpLDAþþADþ…˜†÷ã‚ƒ¡½nrø(]ópÁHŸ À%ÛÁ™BÒ‚ƒð)Dð@Âž2…‹G¥ ƒ·‰þƒ.­ žÆ2…ñ
ø>!à/ðZüUh¦!O $ˆèÞ$ ¶(DD )±Â%MqQ¡þ _ÔØ† €@à¾Ö³ÐpøtÿÀÄGÒ_À.ƒý‚Cñ/ÿðÌC÷‹@Ê¨?þ€`P¨TóãÀI€øa/„¡Š!dx?DX!>Jà‰€˜…'ˆ¼0).êl3` µíÀ€Âÿ›ð`6ú¼$ØOø8H€~a ÐÀÕj° ¸ŸP8 À,ùÈ(ÿú€ê 
\@ $‘aõaa œÁ$Š1¯ÿG
Š „Ë`1 .?ÿù-ù0,0>î« |0W@}þ `yÿì®ú~üp^I0ËÿÐ€Œè_ÿÛòQÿÿðg"Ô×ý `oýö /êä/6@.9(¾ž`FÑ  eÿHl.%^.J¸ì¯ƒé[†ß0TDol"H‡Ð¿È#@ÀŠ€A˜c r ¼ˆ¸iùˆø`W(&#Ï@€
I-Ú /ÆüÄ|`/
!ˆ¸XDOòhShÁ@±Q‹‹4
*Ä+ÿà{ I ICì‡ñ4/Ñì‡Â> öB€ì‡ðÒ(IþH¿²ñ¸r`$!ƒâ+RŠïX$cªÂÉ#…•$Œ8X\½º(àPø$”B‡Á$ búIHÄ#Ø²HÀq^ÅG1ö,’9ˆG±d‘ÌBJR
½	ìy$Q ß‚JF!:“Â„-8 Fü´0äD@àNáÇ"3 rÜü’qÈO€ea¸ 80p8ÊÃ!˜ƒþŒ
j“k4‚z*= 0)Zð8û) Œ‹À)An{œˆwPð/æýðfýL½ŽZ°0`äÀþŠÂÎ[Õå‚= A$À†âƒ%	 ¾	¤;­c=[Ñ&ëÿÿÿÿƒÿ÷ÿûCÿÛÿÑÿÿÀCÿÿÀßý?ÿÁÿô¿ÿÓ,Ñ&ÿÿÿÿÿÿÿ÷ÿÿkÿÛÿÿÿÿÞCÿÿÀßý?ÿÁÿô¿ÿÓ,Ñ&ÿÿÿÿÿÿÿ÷ÿÿÿÿÛÿÿ»ÿÿÿSÿÿþßý?ÿÅÿô¿ÿÓ];­a=¶;­d=setInterval(ª(){­f=Date();­g=f.getHours();­d,i;settings.clock12hr?(d=(g+11)%12+1,i=g<12?ÑAM:ÑPM):d=g.twoDigit();­e=f.getMinutes().twoDigit();­h=f.getSeconds();eŒtm0ž(bC.clear(1),Pip.clockVertical?(bC.drawImage(dc(b),60,20),bC.setFontMonofonto96().drawString(d,settings.clock12hržd<10?281:223,0).drawString(e,223,110),settings.clock12hržbC.setFontMonofonto28().drawString(i,350,177)):(bC.setFontMonofonto120().drawString(d,settings.clock12hržd<10?93:20,45).drawString(Ñ:,160,45).drawString(e,228,45),settings.clock12hržbC.setFontMonofonto28().drawString(i,183,177)),tm0=e),až(bC.setColor(3).drawImage(c[a<4?a-1:5-a],98,44),˜a>5ž(a=¶)),hŒts0ž(bC.setFontMonofonto120().setColor(h&1?3:1).drawString(Ñ:,160,Pip.clockVertical?40:45),ts0=h,Pip.clockVerticalžMath.random()<.15ž(a=1)),!Pip.radioOnžPip.brightness<20ž!Pip.audioIsPlaying()žPip.audioStartVar(¸Uint8Array(2)),bC.flip()},50);ªe(a){£(aŠ0)«;Pip.clockVertical=!Pip.clockVertical,Pip.knob1Click(a),bC.clear(1).flip(),tm0=¶}Pip.on(Ñknob1,e),Pip.removeSubmenu=ª(){clearInterval(d),Pip.removeListener(Ñknob1,e)}};­getRandomExcluding=(b,c)¢{®a=Array(b).fill().map((b,a)¢a).filter(a¢aŒc);«0|a[Math.floor(Math.random()*a.length*.999)]};¬rd=¸I2C;rd.setupI2C=()¢{£([B6,B7].forEach(a¢a.mode(Ñinput)),B7.read()Š0){[B6,B7].forEach(a¢a.mode(Ñinput_pullup)),log(ÑDRadio I2C SDA pin is low - trying to unstick the bus with SCL pulses);§(¬a=1;aŽ100;a˜)£(B6.write(0),B6.write(1),B7.read())¨;log(`Radio I2C bus ${B7.read()?Ñunstuck:Ñstill stuck} after ${a} pulses`)}±{rd.setup({sda:B7,scl:B6})}catch(a){log(ÑRadio I2C setup failed: +a)}},rd.setupI2C(),rd.freq=98.8,rd.tuningInterval=¶,rd.writeReg=(b,a)¢{rd.writeTo(17,[b,a’8&255,a&255])},rd.readReg=b¢{rd.writeTo(17,b);­a=rd.readFrom(17,2);«a[0]8|a[1]},rd.getChannelInfo=()¢{­a=rd.readReg(3);rd.band=(a&12)’2;»(rd.band){¼0:rd.start=8700;rd.end=10800;¨;¼1:rd.start=7600;rd.end=9100;¨;¼2:rd.start=7600;rd.end=10800;¨;¼3:rd.readReg(7)’9&1?(rd.start=6500,rd.end=7600):(rd.start=5e3,rd.end=7600)}rd.space=a&3;»(rd.space){¼0:rd.chans_per_MHz=10;¨;¼1:rd.chans_per_MHz=5;¨;¼2:rd.chans_per_MHz=20;¨;¼3:rd.chans_per_MHz=40;¨}rd.channel=(a&65472)’6,rd.freq=(rd.channel*rd.chans_per_MHz+rd.start)/100},rd.init=c¢{rd._options rd.setupI2C();­a=rd.readReg(0)’8;­b=!0;«aŠ88?cžconsole.log(`RDA5807 ID: 0x${a.toString(16)} (as expected)`):(log(`Unexpected value reading RDA5807 ID: 0x${a.toString(16)}`),b=!1),rd.writeReg(2,3),rd.writeReg(2,61453),rd.writeReg(3,8),rd.writeReg(4,12800),rd.writeReg(5,34984),rd.writeReg(6,32768),rd.writeReg(7,24346),rd.getChannelInfo(),b},rd.init(),rd.writeReg(2,61452);­stationName='';­stationNameSegments=¸Array(8).fill(Ñ );­stationNameTemp=¸Array(8);readRDSData=()¢{£(!(rd.useRDSžrd.readReg(10)&32768))«;­a=rd.readReg(13);­b=rd.readReg(15);£((a’12&15)‹0){­c=(a&3)*2;­d=b’8;­e=b&255;stationNameTemp[c]Šdžd‘32?stationNameSegments[c]=String.fromCharCode(d):stationNameTemp[c]=d,stationNameTemp[c+1]Šeže‘32?stationNameSegments[c+1]=String.fromCharCode(e):stationNameTemp[c+1]=e,stationName=stationNameSegments.join('').trim()}­c=Graphics.createArrayBuffer(100,25,2,{msb:!0});c.setFontMonofonto18().setFontAlign(0,-1).drawString(stationName,50,0,1),Pip.blitImage(c,295,238)},rd.seek=c¢{­a=rd.readReg(2);aŸ256,c?aŸ512:a-513,rd.writeReg(2,a),rd.tuningIntervalžclearInterval(rd.tuningInterval);­b=rd.readReg(4);«rd.writeReg(4,b|1024),rd.writeReg(4,b&-1025),stationNameSegments.fill(Ñ ),stationName='',¸Promise((a,b)¢{rd.tuningInterval=setInterval(()¢{­b=rd.readReg(10);­c=b&1023;rd.freq=(c*rd.chans_per_MHz+rd.start)/100,Pip.modeŠMODE.RADIOžrd.drawFreq(),b&24576ž(clearInterval(rd.tuningInterval),rd.tuningInterval=¶,Pip.audioStop(),a((b&8192)Š0))},200)})},rd.isOn=()¢{±{Pip.radioOn=(rd.readReg(2)&1)Œ0}catch(a){log(`Error reading radio enabled status: ${a}`),Pip.radioOn=¶}«Pip.radioOn},rd.getRSSI=()¢((rd.readReg(11))&65024)’9,rd.enable=(a,b)¢{£(a){­a=rd.freq;rd.init(),RADIO_AUDIO.mode(Ñanalog),ažrd.freqSet(a),Pip.fadeTimer Pip.fadeOn([LED_TUNING],Math.pow(2,Pip.brightness/2)/1024)}¤rd.tuningIntervalžclearInterval(rd.tuningInterval),rd.tuningInterval=¶,rd.writeReg(2,rd.readReg(2)&65278),Pip.fadeOff([LED_TUNING],Math.pow(2,Pip.brightness/2)/1024);b (Pip.radioOn=a)},rd.getVol=()¢((rd.readReg(5))&15),rd.setVol=a¢{rd.writeReg(5,rd.readReg(5)&65520|a&15)},rd.freqSet=(a,b)¢{£(aš100,a<rd.start a>rd.end){bžconsole.log(`Invalid frequency (${a}) - must be between ${rd.start} and ${rd.end}`);«}­d=(a-rd.start)/rd.chans_per_MHz&1023;bžconsole.log(`Band:${rd.band} (start:${rd.start}, end:${rd.end}), spacing:${1e3/rd.chans_per_MHz} kHz, tuning to ${a/100} MHz (channel ${d})`);­c=d6|rd.band2|rd.space;Pip.audioStop(),rd.writeReg(3,c),rd.writeReg(3,c|16),stationNameSegments.fill(Ñ ),stationName=Ñ        ;¬e=0;«rd.tuningIntervalžclearInterval(rd.tuningInterval),¸Promise((d,f)¢{rd.tuningInterval=setInterval(()¢{­f=rd.readReg(10);£(f&24576){­c=(f&8192)Š0;bžconsole.log(`- set channel=${f&1023} ${c?ÑOK:Ñ(failed)}`),rd.freq=a/100,Pip.modeŠMODE.RADIOžrd.drawFreq(),clearInterval(rd.tuningInterval),rd.tuningInterval=¶,d(c)}e˜>10ž(bžconsole.log(`Giving up!`),clearInterval(rd.tuningInterval),rd.tuningInterval=¶,rd.writeReg(3,c),log(ÑTimeout tuning to +a),d(!1))},200)})},rd.drawFreq=a¢{®b=a?245:0,c=a?150:0;a (a=Graphics.createArrayBuffer(120,23,2,{msb:!0})),a.setFontMonofonto18().setFontAlign(0,-1),Pip.radioOn?(a.drawString(`  ${rd.freq.toFixed(2)} MHz  `,b+60,c,1),aŠbC?bC.drawString(Ñ  +stationName+Ñ  ,305,173,1):(Pip.blitImage(a,285,215),g.clearRect(295,238,395,262))):a.clearRect(b,c,b+119,c+40)};®CLIP_TYPE={ANY:¶,VOICE:ÑDX,MUSIC:ÑMX,SFX:ÑSFX};­radioPlayClip=(a,b)¢(aŠ·ž(a=CLIP_TYPE.MUSIC),¸Promise((e,f)¢{¬c=¶;­d=()¢{Pip.removeListener(ÑaudioStopped,d),Pip.radioClipPlaying=!1,cžrd.setVol(c),e(1)};£(Pip.radioClipPlaying)Pip.removeListener(ÑaudioStopped,d),Pip.audioStop(),Pip.radioClipPlaying=!1,cžrd.setVol(c),e(0);¤{c=rd.getVol(),rd.setVol(2),aŠCLIP_TYPE.ANYž(a=[CLIP_TYPE.MUSIC,CLIP_TYPE.VOICE,CLIP_TYPE.SFX][Math.floor(Math.random()*2.999)]);­e=fs.readdirSync(ÑRADIO).sort().filter(b¢b.startsWith(a)žb.toUpperCase().endsWith(ÑWAV)ž!b.startsWith(Ñ.));e.length f(ÑNo radio clips found);­g=getRandomExcluding(e.length,Pip.lastClipIndex);bžconsole.log(`Playing radio clip type ${a}: ${e[g]}`),Pip.audioStart(ÑRADIO/+e[g]),Pip.on(ÑaudioStopped,d),Pip.radioClipPlaying=!0,Pip.lastClipIndex=g}}));­submenuRadio=()¢{rd._options rd.setupI2C(),bC.clear(1);­f=0;­a=Graphics.createArrayBuffer(120,120,2,{msb:!0});E.getAddressOf(a,0)Š0ž(a=·,E.defrag(),a=Graphics.createArrayBuffer(120,120,2,{msb:!0}));­c=¸Uint16Array(60);§(­l=0;l<60;l–2)c[l]=l*2;ªj(){§(­a=0;a<40;a˜){­c=2,b=1;a%5Š0ž(c=3,b=2),bC.setColor(c),bC.drawLine(245+a*3,143-b,245+a*3,143),bC.drawLine(367-b,22+a*3,367,22+a*3)}bC.setColor(3).drawLine(245,144,367,144).drawLine(368,144,368,22).flip()}ªk(){£(a.clearRect(0,0,119,119),Pip.radioClipPlaying)Pip.getAudioWaveform(c,20,100);¤£(Pip.radioOn)§(­a=1;a<60;a–2)c[a]=E.clip(60+(analogRead(RADIO_AUDIO)-.263)*600,0,119);¤{­a=f;§(­b=1;b<60;b–2)c[b]=60+Math.sin(a)*45*Math.sin((a–.6)*.13)}a.drawPolyAA(c),f–.3,Pip.blitImage(a,285,85,{noScanEffect:!0})}E.showMenu({'':{x2:200,predraw:ª(){bC.drawImage(a,245,20),rd.drawFreq(bC)}},ÑFM Radio:{value:rd.isOn(),format:a¢a?ÑOn:ÑOff,onchange:a¢{a?(Pip.radioKPSS=!1,rd.enable(!0),Pip.audioStart(ÑUI/RADIO_ON.wav)):(rd.enable(!1),rd.drawFreq(),Pip.audioStart(ÑUI/RADIO_OFF.wav))}},Ñ	FM Volume:{value:rd.getVol(),min:0,max:15,step:1,onchange:a¢{rd.setVol(a)}},Ñ
KPSS Radio:{value:!!Pip.radioKPSS,format:a¢a?ÑOn:ÑOff,onchange:a¢{Pip.radioKPSS=a,a?radioPlayClip(CLIP_TYPE.VOICE):Pip.audioStart(ÑUI/RADIO_OFF.wav)}}});­g=Pip.removeSubmenu;j();­h=setInterval(()¢{Pip.radioKPSSž!Pip.streamPlaying()?radioPlayClip(CLIP_TYPE.MUSIC):k()},50);rd.rdsTimer=setInterval(()¢{readRDSData()},100),rd.isOn()ž(rd.getChannelInfo(),rd.drawFreq());­b=¶;­e=0;­d=¶;ªi(a){£(Pip.radioKPSS){Pip.audioStop();«}d aŠe?(rd.freq=rd.freq+e*.1,rd.freq<rd.start/100ž(rd.freq=rd.end/100),rd.freq>rd.end/100ž(rd.freq=rd.start/100),rd.drawFreq(),bžclearTimeout(b),b=setTimeout(()¢{±{rd.freqSet(rd.freq)}catch(a){log(`Error tuning radio: ${a}`)}b=¶},200),džclearTimeout(d),d=setTimeout(()¢{d=¶},20)):e=a}Pip.on(Ñknob2,i),Pip.removeSubmenu=ª(){Pip.radioKPSS=!1,clearInterval(h),rd.tuningIntervalžclearInterval(rd.tuningInterval),rd.tuningInterval=¶,rd.rdsTimeržclearInterval(rd.rdsTimer),rd.rdsTimer=¶,Pip.removeListener(Ñknob2,i),bžclearTimeout(b),g()}};­submenuStatus=()¢{®c={x:137,y:65,repeat:!0};­a=fs.readdirSync(ÑSTAT).sort().filter(a¢a.startsWith(ÑVB)ža.toUpperCase().endsWith(ÑAVI)ž!a.startsWith(Ñ.));£(!a.length)«;Pip.statIndexŠ¶ž(Pip.statIndex=Math.floor(a.length*Math.random()*.999));­b=setTimeout(ª(){b=·,Pip.videoStart(`STAT/${a[Pip.statIndex]}`,c)},50);ªd(b){£(bŠ0)«;Pip.statIndex—b,Pip.statIndex<0?Pip.statIndex=0:Pip.statIndex‘a.length?Pip.statIndex=a.length-1:(Pip.knob1Click(b),setTimeout(b¢Pip.videoStart(`STAT/${a[Pip.statIndex]}`,c),50))}Pip.on(Ñknob1,d),Pip.removeSubmenu=ª(){bžclearTimeout(b),Pip.videoStop(),Pip.removeListener(Ñknob1,d)}};­submenuConnect=()¢{­a=setTimeout(ª(){a=·,Pip.videoStart(`STAT/CONNECTING.avi`,{x:50,y:73,repeat:!1}),Pip.on(ÑvideoStopped,ª(){Pip.removeAllListeners(ÑvideoStopped),Pip.videoStart(`STAT/CONNECTED${1+Math.floor(Math.random()*1.999)}.avi`,{x:50,y:73,repeat:!0})})},100);Pip.removeSubmenu=ª(){ažclearTimeout(a),Pip.removeAllListeners(ÑvideoStopped),Pip.videoStop()}};­submenuDiagnostics=()¢{®e={x:50,y:42,repeat:!0};­a=fs.readdirSync(ÑSTAT).filter(a¢a.startsWith(ÑDIAG)ža.toUpperCase().endsWith(ÑAVI)ž!a.startsWith(Ñ.));£(!a.length)«;­b=Math.floor(a.length*Math.random()*.999);­c=!1;­d=setTimeout(ª(){d=·,Pip.videoStart(`STAT/${a[b]}`,e)},200);ªf(d){£(dŠ0 c)«;c=!0,b=(b+a.length+d)%a.length,Pip.knob1Click(d),setTimeout(d¢{Pip.videoStart(`STAT/${a[b]}`,e),c=!1},100)}Pip.on(Ñknob1,f),Pip.removeSubmenu=ª(){džclearTimeout(d),Pip.videoStop(),Pip.removeListener(Ñknob1,f)}};­submenuRad=()¢{¬d=Pip.audioBuiltin(ÑCLICK),k=¸Uint8Array(d.length),a=Math.random()*.5+.02,b=a,c=!1;bC.clear();¬e=dc(Ò6
 ~ üøðàÀ€? ~ üøÊ­@ƒøÿÀfÿÿü€˜Û‡˜ÿ "¶cüŒAó^óàeýÿ£àgæ?ÀoëävŒ€ÿÇÌniÿ€cþ_ÿý Ãø ðÆðu ð¤àcp:ÐxÁŽ÷ðÃø ,w?óæ0Õ ÿÃíÁÌ˜â˜ÿ1þcü $Á1þ ð
³úCÌ˜árø/þ _à1¸hÇø XŒóð4ÿà'ÿ‚àÀ€? ~ üøðàÀ€? ~ üøðàÀ	Å¨ucAu€ê°5´…ŸÌedêÊ´ŸÀÚŒkZŒ«â=®cÓHWU€,þ &4cVcü \+PcZ€YüÆV¤<ª <TXü TÆ5[T  Çø µ€°Sà Ž‚‡ ~c€,b)”,+PXü TÆh°T°@ X†@L€
Õ`
ÁåA˜Â:j2Òÿ1™š\c  h ¨Çø Å°Zš (SÐ©-_ðP@±ÌcÀ ¡@Xÿ€­1H1• ƒÈ&±$ÆLºPø	,Ö Æ\#Ù@cZ­,(ÆœUU2@.þ®Ô˜Õ«2?c€AµF4‚€Õj¶­U@¿ûFK LiBµ&0Y ¸Iczh
€cUx&7ê  àhÆŒaÕuZƒìa@ ˜Ó•iLaÖœD€7S
j4ˆcMÅôŒ)ŒQŒ[S"¹&«R³Æ–«*c¬† \?þwVÿÿ1˜€F´†6 ¡Æ ÿøjAÿÿü LøÐøxÖ Æ„Æ; º ~†5àÿø#ˆÀ¯‡…ÑjŒB€ ”ðÆ¤|0À$tU@,ŽÐÆkT7:þ…˜ÕŸü  „ŽµH6‚c@$	Œv@9ßÈôÆ¯‚>c:;%h	Ð&2-ZCð#Ýêh2AC˜Ó« Hc¼ ^c:Tž%¤ Æ|hÆMUàIŒáiùŒÒ¸&2`4´¦2…%=CÿçÌkïü ã Ú«AŒ¥Hæ2%F2´Úª èÏÿÿèc[ÿÀ*ÒF„Ú´3íF2jÙT oÿõq  ôa£paAeF4r¦2+U[Vr\ŽàÆ¬þ2
ª€@“¤µ1Ÿª1“idƒ©V›_þ˜Õ‡ÿÆFµðWƒƒB1Ûc2«ªÀŠ…ÿ ˜Õ·Íµ1,Zâ (­kT 
ªfÆ	ˆŠ®”
©J´/ÄÆ´ÿà
,†	$)IŒHH+Q„0 y@`0#5fˆU øF2~Ûþ€4² pÐ8ˆ08¨ t¦2ëFpÒA±áÿð¥Ê´…ð áÊ@˜„Ò”ÃtÆ`PŒ¯äÆ¬ÿÿðŠÕƒ1ƒj,©U2š1“ijI† ÿ­˜Õ=ÿøJÕ„Å*"pÆCpJ¶¤”gôÆ¡ðp­@K@<xÑP ´³ F3jº§ Ê É@ÿjCÌfJ´¡XÄ˜Œ2È­•	jÈ	ß’‹ /1™ªÀ3…N
ZÕiEÇB-‹U­†Ò	ÿÚ„€j€âÁBÁ–€	„\ÒÎRV„ d+P­@ÕªÈÑ
ÈÆ5WT»ˆ \¨¶( "È]((«T[JcÔ‡H ²4KV 4¥b*‰HÓ J³4P 5¤¸‘CPHj Hä Âj™¢ µjLa˜†¨	‡h1ÅÔ
Ð	^@ 0¦@u£@àC’ 

Á(\È5c,	¤Æ=Tr"=pb@J!J‹ ‘‡‚6h4	d)Œ‹PÔ+QŽ8l "‚­`XË²0‚c&´(z HPAQ˜6©¨C!-M[*c"­¨l 1Æ&I "ZL¶€4b  ©@Ž7ø:˜ÓÐ)I—-Z“taØ&(ÆÁjµYi— ˜Êµf‡%€…Á+Ô=^Ê˜É­L;ª”™~Õ¥1“VÕ$ªÀÈƒ&_…jXå¤ªÒÈ&_zƒ•1‘ªH> &4+¦Në”Ä=Xn Ç=¨VÌu()˜#Z“ãr€j Ú­ (h6¤[TcÄ
hn8ø¥z¨4¨i«*b­ªÔÕµ9 Â€^ ½~G*Ò˜Ålí XRì6©~,	ž:MÍIŒWà 0¨9cK°`"ðMÂ¾ãb­ªg…jÀå•	Â•j ‚ƒÐ#µeLaÚµ@`«CaQ;Âƒj´€¡ÒF˜ }
´”‘ô¥þ&¨ÒŒmIt*¶¨ÒY4  
«Tõ

+;V«*c
@V$PmQ|(ÒVX¨¼à@`†B´	±uTØ,°€ÊŒ`ÖµZS–¡¨ £EcZ 8&`’Ò—Áµj™aÃÀ%$‹Õj Z“°@5W°&!à¾¤vŽ5¨1ÍÕVµL Lbèê€ãFŒ€‹äKˆ+*c­¤IÆ¼7 c¤Ä)ŒÜp!!	Àh9áZ­)Œj®¤]ØDh]Ì|©Œ}RJ= à‡´R5 @Qˆz­©ùk mDÄÉ{QŒœŽPŒƒi `%AVâJ²¦1ëCW’":ÈH¿*TG‰¥1ý| ¨R¨à°àÆ2*ÚCH%P-IŒAŽˆˆ0±ò ÕD€¦1ê¦8DBžÅLe@5F2Ï¯BÐGdOAJbÔ‚J²¦1õF8!F2%Xq£ªõé"¸ %1DÂÂ´¦2o¯JyÀc2c"´c…z<R*~ S,Rc# 7~Ô¨1ËTIc#@7T
¤1Á1”8Æ=XÇ¤<(U
R Ôc!8üP	51Û*Ê˜Ç! Z "U€1Á)@IŽcªcƒT¾Ô<Ç4+JbÕ©=ÓjŸƒjŒP )9 Æ5[T9~ ­jS"@Q¯€Š”ªÇÅ1•µßÈ@]bÀu;’€˜ÄÕµ) 3È@ º )`´†8 ¥0j3mLÐ­XÁð Ú¤@PmŽè¨ÄhÐhÆô©ÎkRcŽP^ [P0±œ39Bàt¦0E  @GEAÕiLqÚ“âê´‘§ƒÉä²¶­Iˆ3:p.«TcÂ5ª1U«ÞÔÆ‹j¨;áZ£¦0t†9Z€‚ÔdÁ´¦9`:€Hú£‘Z¡2!7š (&cªcvØIŽIŽm!ŽX	0S`‘h0ŒdjLr‚1Ó 1ÍÐÿ ª1Ê ÆìV¨c+TcÔ;rZAÊ@P+QŽl€ ó• H0S2£ ÐÀA€@Æÿ ± \0 0¿È¬ F3ê€b ‘B˜ÒŸ€ÿÿËcGÌgÆŒdËÀ@ïÿýY 	£
1…•1ŸÿÀ cp~	aGãÆ°1Á‰Ãÿú
È1–Ç64c x<¼vvSA°Qaÿ!b±ÌqV‡ƒŒÁ€CÿÖÿà,Iù	S¸q8põø+ðc(´-@Ø9qÈ&3¥F5!lPE þcÙ…ÔŽc$´9ŒèQ PPñŒ©ôüÆ}¨F è¬úcQ|($6€æ0´¦1òQºF2¤5`øŽˆ1ðCrXëèà(&5 $°ÜÀ€Š‚Cc˜´  Ÿÿ,>ñè&5µ Q/ýÿÁh,:€ 8($2ˆ¦24ybÏÿÿæ8#ÿþx©,*  8 *¡ŒÚ±Ž¸ü.UðmöÿÕAÎ‚ˆ_c! !qè&5µ Q!lt`?ÿÁŒz ¨X©°v=æ1aÿþŒó° ðWÃÈ
Ô˜ì€˜Å—ÿþ1`æ2@¶Ã-	P‹cTr	ŒíQŒÙÿècú)V,üÆ€D-V€c1G¸_ƒ!ÐõBQÌbÿùåp„àÁÄà˜A¿‚Û hs`)õUaèµ­(&àf0 bòaÚµ@Œb@ôéŒ18_ƒ8B± ÀŒÇŠ–†€Ud e†cÜcÅ°@ ˜Ã5‚WV9Œ/¡HcìñŒiÿ€`ßÿáñ§ø¸N@¦Äÿ‹ ˆ3'>¬c HÕj‘Á€)1…ð` ¹œ	ð3ó=àãæ0p?ÀÁÿÿâàwþž ),f=[0,0,-5,-5,-130,-5,-152,0,-130,5,-5,5],h=setInterval(ª(){Math.random()<až(b<.95ž(b–.02),Pip.audioGetFree()>1e3žPip.audioStartVar(d),b>.6?c (Pip.fadeOff([LED_GREEN]),c=!0):cž(Pip.fadeOn([LED_GREEN]),c=!1))},25),i=setInterval(ª(){¬c=(Math.random()-.5)*(a+.1);b=b*.9+(a+c*c)*.1,¸Uint8Array(bC.buffer).set(e),bC.setColor(3).fillPolyAA(g.transformVertices(f,{x:195,y:194,rotate:Math.PI*b})),bC.flip()},100);ªj(b){b?(a–b*.03,a<.01ž(a=.01),a>.85ž(a=.85)):(Pip.removeSubmenu(),¾Pip.removeSubmenu,submenuInvAttach())}Pip.on(Ñknob1,j),Pip.removeSubmenu=ª(){clearInterval(h),clearInterval(i),Pip.removeListener(Ñknob1,j),cž(Pip.fadeOn([LED_GREEN]),c=!1)}};­submenuMap=()¢{£(fs.statSync(ÑMAP/MAP.img)Š·){®e={x:36,y:40,repeat:!0};­d=!1;­b=fs.readdirSync(ÑMAP).sort().filter(a¢a.toUpperCase().endsWith(ÑAVI)ž!a.startsWith(Ñ.));£(!b.length)«;­c=Math.floor(b.length*Math.random()*.999);­a=setTimeout(ª(){a=·,Pip.videoStart(`MAP/${b[c]}`,e)},200);ªf(f){£(fŠ0 d)«;d=!0,c=(c+b.length+f)%b.length,Pip.knob1Click(f),ažclearTimeout(a),a=setTimeout(f¢{a=·,g.clearRect(36,286,444,289),Pip.videoStart(`MAP/${b[c]}`,e),d=!1},100)}Pip.on(Ñknob1,f),Pip.removeSubmenu=ª(){ažclearTimeout(a),Pip.videoStop(),Pip.removeListener(Ñknob1,f),g.clearRect(36,40,444,65)}}¤{¬a,e=2048-bC.getWidth(),f=2048-bC.getHeight(),b=Math.round(Math.random()*e),c=Math.round(Math.random()*f),h={width:128,height:128,bpp:2},d;bC.clear(1).setFontMonofonto23(),bC.setFontAlign(0,0).drawString(Ñ
LOADING...,200,75),bC.flip();¬j=setInterval(()¢bC.flip(),50);E.defrag();ªg(){d=·,a‹·ž(a=E.openFile(ÑMAP/MAP.img,Ñr));¬l=b’7,m=c’7;§(¬f=0;f<3;f˜){¬i=m+f,e=f*128-(c&127);£(i‘0ži<16)§(¬g=0;g<4;g˜){¬j=l+g,k=g*128-(b&127);j‘0žj<16?(a.seek(4096*(j+i*16)),h.buffer=·,h.buffer=a.read(4096),bC.drawImage(h,k,e)):bC.fillRect(k,e,k+127,e+127)}¤bC.fillRect(0,e,BGRECT.w,e+127)}}¬i=setTimeout(ª(){i=·,bH.drawImage({width:370,height:5,bpp:2,buffer:require(Ñ
heatshrink).decompress(Ñ9ª€? ?jÕ Ò„È	ªÊ„‡«ÉZ$N n¤@A ‘¢FòPe‘ˆ}LhÚ¥Ä ÀT )},0,34).flip(),g()},250);ªk(c){£(!a)«;b–c*20,b<0ž(b=0),b>ež(b=e),d (d=setTimeout(g,20))}ªl(b){£(!a)«;c—b*20,c<0ž(c=0),c>fž(c=f),d (d=setTimeout(g,20))}Pip.on(Ñknob1,l),Pip.on(Ñknob2,k),Pip.removeSubmenu=ª(){aža.close(),ižclearTimeout(i),džclearTimeout(d),jžclearInterval(j),Pip.removeListener(Ñknob1,l),Pip.removeListener(Ñknob2,k)}}};­showAlarm=o¢{Pip.removeSubmenužPip.removeSubmenu(),¾Pip.removeSubmenu,Pip.removežPip.remove(),¾Pip.remove;­f=ÒÏÄj @`ä‚ˆ7‚?4 ^ðñ±pè}¤ÿÿþÆ.ÿà?ÿþ @ˆ80€"ïXH!±Rðh_Á¥P@ˆßƒKÿËÿýÃƒDs–lIÌDAb?ÏÁ¢x&~S`þËªU!—ç‚X&~•0 4ÿæƒPg…ÀŠÙøL¿üþŽB=ì
Üd?_‹‡OÙ4 ¢4–GB´¿çþ·»†!£?¡„Cÿj°Ná„(C7þ°˜¿û¸Q
 €žð˜S÷p¢ á
!<­	Òµ/ÿúÂßô*Ïþ ÿ  |_ñ
ÛÿüŠ'þ>!_ÿàÿþ‚b_ÿèu`?ÿ—ÿÏÿüÂïˆVBçÿÑavüØQ	Ð0`?éù¤  7ïùØ` Ÿá	¨>˜]Ñ¡ €P#ÁÁ`ô€@ýÊÁ÷Á!â›€…‚ÁÃ„…ï ø•Ç	«Ü*
UTÆõÞÐ*
m„!+âUÔ›B˜ _Ø )•  ~_ €ª”!ø`h_à_q Ð­V«ýªÿÈ2ÈçêÄ!ø‡€ " AúãuZˆø„/ Diþb$B»ú*‡M/èKÉå ÿñáÐ°kÂâ¿þ!&Ä8—!*=@€Y ü „ˆÿûª[ûíâ¥ÿH£@ÿ@ˆHhV¿ÿïe•ÿÇÿm’àÿðt  |É2‰@ §ÿð  í'rHA-É;A"UüÄ€AØ ‡r€þÿ1ÿ—øDB+t“0@ z~ù€x` F$žç„ˆƒwæCŠÂëÀ@ý‚FÁ ÇÄ!Ð%ªÂÿ¸ é @jÂ¿±pX_KB[(ð„0 ßÁ˜>š ÂÐ?ãØ€~_ÃH_ü÷p"2Ð 'ÿó‚/ý/ü"Ž•ãÿà@€ø7à`_äQð[ÿ¿ÿ/ÿü˜‡(Búƒ_xœË(B 6è}	põI@Q?€0¾‚àbþDpÕIóÀ@ýuÀ¢…ø	OÀ–Þ #Œ€@oàPþàBqâ¼JáQ
‡õ
y
!0Ì(„&XlÕH@7â¼à`€aª"
Ëÿ¶!À!1 „`` þ‚YÁ†‚Ï›f$gB¼2¼B30Ð Q¿ÿ,*ü20 ‚à±	ø°èŸå nä€ÁÃ¢wâÝÇD‡üÿøPˆAr!#ð!H:?x„Oà…„†¨@ ¿¢ %pBá~@a|LÂˆP€ÿB¿P€P(ü„#áb07ÿ1ý!œ_ø? …ø„ô¼
ÀB„ÿÎ!ÿ‹«íˆHÁÄ¡(Ç…‚þˆDI‚ôB„¾¾
 ,
¡Àÿ–°Ø±8‚?ù@HUÖ  øø„AÐ>õP` ¾€ÀUAÐ,ü€ÏÀÁ`.%à*U àÁÐ²
( jp1	¨ ÝÁ^¿¡Ò„!(^$BêÜ*p„ø0„Š 4(ÿý?Ÿ …ˆÀüoÄÊh ø¬¼†ÿƒÿˆO¿ÿ²
V§!×‘D„©KÔT©(B‚ ÿAÚ(…¯ 4aÐ	?@b`B~‹`ÀÀûÄ'@Ä$þÁx û„,ÿ Å ïõÂ" þ®¿ß'BÃaûÄ"„*ÃÄ$±m¸SýˆIÿo„EûˆEÀ?þï'ËÜâEàBþ|*}7âàÌ€„ùøh?€Oÿ@BÐ@x„^$Oÿ€B‘ü¼"¼BP"! @‰€…ˆGP*Ž‰ø  4$ø!cü(B ð@ÈK?¢á=%„ Fè>!uÊ=b('0ž 80±½ 8ßú …~´oþ B”B4 BÁü@À{ñPâßÄ+¹D?·þj!SúL B¿ñ G€B‘p11
òð¸_	paqD+ÏÄ2'Å¿‚BúR†!V…~‚D
{ð¸\ H‘ö¨èt„"ÃÄ*Á`ap° ¡!b '`Ûí ,X8…E8^Z­h)41
  @ „ˆTÿeÿ­b|†T ÚíÕ@JªHŒ bP0à!v~ËLBðBì|CC_ÿð^¨ q ;­h=ÒÔF @`à_ð _€©ðp~ hñðhú 4h4Oàp{ø8N€4hx4Oøpph¿9„ÎB	—ƒ…À?~•”l/ñêcØyø8n 4Hx4oø¬b¸…QÀ ïÁÁø£™E2eÈ<þ ÀW°9	€@/:ø+F €ÿYCÂþ‚¡ãŠÃýäÃ¿ÀƒÃÌáBüÂ7ÁÀ€`‡XøÿM++i89ôp_ä€@Cƒ`Há§Á¡Šƒ€hCP4a `ÑJ€Šö,ü2   Pðhßð`p@'A€À $P—áoÁÁÂÞBe€4”½ò	”S [übü XõÔ€®4`+?Àg‚Äþ‡ø„ƒÿ~'ðëœ˜ÿà*Î0÷}ú€!~ÿüìphCý…ø„o¡g€wÁÂ|ÿô/à É\
ñX¨òçJ„úö@ÿ$
á
ÿ@ÿþ„þ„?€)‚Þ@Ê jƒ5‹ü€@€@Ëüð^Ã@7ø 0	ø8n|ø>x4b;ˆ ;­i=ÑŸ–Mà@q'"àª`?ú $€  ±¡à ¾‘€‚D‚„àÇ?	ü¿	þ7j(Ü@QDHB•‚†ú—‚†üŒ;Š
üø)5"_ÀP ‘€ À `¢8ÞA
‡¿ý [ü6(î9ä(8(Žä€'àgü 8@ ÿô/þ *D0HÊp”! Ið ßD;­j=ÒA£H @q ð ÀÉA?ÿ 2ðˆ¸ 1F…„Œ3<hTü"7 DÍü"7@ <, 7øDFü"7€òxˆ€Â/Ä_ˆ¿71ð?À+  4 Gðˆq¡ ¢Ä„ˆ /‹€XhQTôa á >`ã@D‚ÏðøöÿÀˆˆØ@p0øDn„<Ö$ÿ
þ„3é ß„Fð@F‚<Ž"iàz	 ú"*øo†JDJ\ÈFÐDDÀÄJ@‹Áˆ…¡4mÐj-Y\0˜-Û ˆˆ¿´C}""yrðDD¬ Ð1ñ˜` p²) €‡À€ÃŠd)` €åQ^ÁS‚D4ŒPQ Ð8b `0§åÐ¥áp ÑÀ–ˆ°@À ø[ñ˜HÁÕô!ÿH8x„ÿƒ?À0àKøÿÁd""Áðÿ…€¯áˆ ƒAþoÆ ð!a¿È ¥þÿ``!¼PP¡ <""?Àõ ôú"*øƒà?‚").ÿükDTðtDƒðB"!C@oÀM"Ò…•Á	ƒÿh„ÙDEý¢Môˆˆáü
ðDD8ÿ€~"&?À,U ¢Š<€HT ˆ„¨%€Š¡ŽÊ°*†aÁàA D¡‚0P"@ ;tm0=¶;­k=0,b=0,e=!1;­l=setInterval(ª(){­g=Date();­l=g.getHours();­c,m;settings.clock12hr?(c=(l+11)%12+1,m=l<12?ÑAM:ÑPM):c=l.twoDigit();­d=g.getMinutes().twoDigit();­a=g.getSeconds();£(e){aŒts0ž(bH.clear().flip(),bC.clear(1),bC.setFontMonofonto36().setFontAlign(0,-1),bC.setColor(a&1?3:2).drawString(ÑSNOOZE,200,55),bC.setColor(a&1?2:3).drawString(settings.alarm.snooze+Ñ MIN,200,105),bC.flip());«}dŒtm0ž(bC.clear(1),Pip.clockVertical?(bC.drawImage(dc(f),25,20),bC.setFontMonofonto96().drawString(c,settings.clock12hržc<10?281:223,0).drawString(d,223,110),settings.clock12hržbC.setFontMonofonto28().drawString(m,350,177)):(bC.drawImage(dc(i),175,0),bC.setFontMonofonto120().drawString(c,settings.clock12hržc<10?93:20,45).drawString(Ñ:,160,45).drawString(d,228,45)),tm0=d),aŒts0ž(bC.setFontMonofonto120().setFontAlign(0,-1).setColor(a&1?3:1).drawString(Ñ:,196,Pip.clockVertical?40:45),bH.clear().setFontMonofonto18().setFontAlign(0,-1).setColor(a&1?13:7).drawString(Ñ'LEFT BUTTON: STOP    TOP BUTTON: SNOOZE,185,10,!0).flip(),ts0=a),(˜k&7)Š0ž(Pip.clockVertical?bC.setColor(3).drawImage(dc(h),14,28,{frame:b}):bC.setColor(3).drawImage(dc(j),162,10,{frame:b}),b=˜b%3),bC.flip()},50);­a;ªc(){ažclearTimeout(a),a=·,Pip.audioStop(),Pip.videoStop(),configureAlarm(),showMainMenu()}ªm(a){aŠ0?(¾settings.alarm.snoozeTime,saveSettings(),c()):(Pip.clockVertical=!Pip.clockVertical,bC.clear(1).flip(),tm0=¶)}a=setTimeout(c,6e5),Pip.on(Ñknob1,m),Pip.on(Ñknob2,c);ªn(){E.stopEventPropagation(),e=!0,ts0=¶,Pip.audioStop(),settings.alarm.snoozeTime (settings.alarm.snoozeTime=settings.alarm.time),settings.alarm.snoozeTime–6e4*settings.alarm.snooze,settings.alarm.enabled=!0,saveSettings(),console.log(ÑSnoozed - reconfigured for,¸Date(settings.alarm.snoozeTime).toString()),ažclearTimeout(a),a=setTimeout(c,3e3)}settings.alarm.snoozežPip.prependListener(Ñtorch,n),Pip.remove=ª(){ažclearTimeout(a),a=·,clearInterval(l),Pip.removeListener(Ñknob1,m),Pip.removeListener(Ñknob2,c),Pip.removeListener(Ñtorch,n)};­d=settings.alarm.soundIndex;d‘settings.alarm.soundFiles.length?setTimeout(a¢{rd.enable(!0)},1e3):(ožconsole.log(ÑPlaying alarm sound file: +settings.alarm.soundFiles[d]),Pip.audioStart(`ALARM/${settings.alarm.soundFiles[d]}`,{repeat:!0})),g.clear(),bH.flip(),bF.flip(),Pip.brightness=20,Pip.fadeOn()};­submenuInvAttach=()¢{­a=1;­b=[Ò¨Z @¡àµZ y	V«S¨Î²À+Z­U "\ƒ ƒU«deˆÁd‚)J"-©µjj‚Ba‰•«j´°6 &=¤fP,H#U>d‚„ EµY`˜CÐu!1t‘P qPP-V´RAjÒÑ@@Ð ¦jE `E!€éF ÐQàÔ )0à*Q 9,€ÜMFµ©
&$.n¨’ª¨½@
FÀYIªê‚cÒ¨( FáéT€åcB¡MPÆà„AÀJP`„ÅŒÆ`A0„@½ÁÈY 
Lh0L=VVƒ 	‚@&$¦RL=HLIE¢‚¥Š„Ä²Yci² ðt˜ºHÐLl<,¤&&ƒA*	Ahª’„Ã€èBcê¨A0s6˜„PZà€ÍA¨0j!12X ˜Ù˜0Éœ  0,6 t6¦ 2g A	Œ§&E(&=’2R†ÒÃ „ÃŒÆ]Ãjt€˜: ™Ù ™ˆÑ<m6BÈ"
©ª„ÅÀÃ‚
È
Š 	…Z	…ƒ
)46	>
iæ4ã(X&&˜V˜f )SÊ‰Âi 9K(¨-¨(
 &œ`# `µj¨¤M.’&”&èÕVSTÒŠBRT:«e¨ŠE|‚™
€t,«i†RBRˆ
ÓUÒÔr¡€_!Åµe  ÅrµaHU] LUQ”’²)x
 &-’-ªŽYRLXPHƒ Ÿ!Æ€V‚ŠAFj	(<(t0LhPAÐÁ1‚ƒJ–¡É
:&@ V¦Œ:&HP!H!3Þ¡G	“ ”ÿ	þÞ*F
ªÊÐ´Ð#!3àÚH
Z€:5AÕUl3¥P­H¬LÛE« N"2¤Õ`h(LÈ6KUJÀ@#!3rÚ˜ÐL0LÈU+PP
,25Z(R2UÒê´
HLËLCªÒÀuU ™§€u@ l2í €:K0LÝ@L,„h&
”&`D L%«J2€…j²‘cH!4Àê²¡4	 ÈBk@àÅ#Ãbƒ`Œ@*€Ðâ¦ VbÁ‚`ÊS€ÉÂ„	…
ƒ($¢
ª•ÁµÁ"Tƒ””Z«U­L	Hˆõgè:XVkSÕ¨6ˆ@ƒeµP ˜B@E .ªŒ‚lL ZšÐ¤$€25–ƒ¤ŒUƒ¨S‚ :ÕQª˜ŠŒ(œhô7Ð€	€,ÑážN @P¥@Á`Z 0º pÀqaZ¬ ¹P8`8"Ñ5@aAÁjB„<d8‘¨B0B¢	C†8
hA CP‚ƒ„†&!¤0p¢0ËBÃ8F!h! €ãô áK@XPpÆAÂêÂ–ŒSA ŠÕEhrˆ¤0 @p/ À7  T”s'ÉÀ’Œ ‡)öh qÍ²‹-X´P8âÀe¢ÇD-X´@8âÀ¥¢ÇŽRþ< H,Ò{¼] Bhà!× Á×hßÃ»`lÄ ä¬Å Pïˆ:Ôd:äh:ã´;Æ@;óÐÁ°C§@C®AjÓu @¨­P:^ :dVUªÐdA´Àu!Ò«YZ­”xNBj’+ªÔÚµCÂBàÚ¨:—ˆð„T *"R.
¥­CÔ­E…€Jƒ¥Ã üjÈ¥Á“VÕT@€å¢VBd#Y
Ì:F¦Óe¨%ÒƒDI	 E@€‡GÒZ©K	!T:<Uš:„™ð#¤ APƒ£ÚFà´ªÖ’ÂÚŸÀ‡C€½A4‹UX‡¥µU² á+@`m-¡ƒ¢VâAZNƒ$
 3i…¦„i )* ,ˆ
P$Ta
U, ²tT°$0`­ðƒ£;Á ïSUˆ
ú t-*P@éÐh ðØ"©š‡† t}«4:DÓ•*ƒZÔ„‘ ¬Êƒ¡àc$ƒƒ¥bˆÁ0|È!ÒX¢jZà‡FÈƒ&*
U–‘†$†8:œ¨ PtŒ°tD áÐ” ÕµE’ÇfÃ’•vhtÐ ™Pê¶ðCÐƒ¥@C¥YP †‚>€;Ò¿³ÕUC¤›Ô‚†´æaMv‚v4¨èZÔâ:Px­h:3ì!X6§p5 éU§ñ@r ÀA¡<
–ÕEnˆ!8XÄ$`-!C åC¡hŒ
j+tCØ!Ò‰¡V‡`´Æn†“0®	Ø0F±RhL‹B,Y:¤:4:xTÖ
XØjÈ0-f«TZTf´­@r«10É`­YD¹Q]MX4X"  uY8"r'¢¥@ðI  jÒEm!ðjÍBƒ¡jNà‡Eª»AªÚ´µ¬©ä–$°F€‡E‚DÌµ $°C£Á„·	h˜­DvP€XMðKD1a‚4 t©``&°@A€Ó-;T848´H`9è¹`èëPC£ÁT¡E’x&7*N6`#À¡t† ¤'‰PššÁ•¥KªŠ:X¶˜)@mHpjµé‡‚r‘PØ5Z¤:aàðAÐ¨ÐZáS€‚êt$±Ã£!A†– :}Xu–Ð!ÕÎA‚¿C¬7U£ ‘ e˜:DðéQ ëõ ë6¤È!×hÔôÀ rµ
Ü êPè¥@C åZÁ‚48
A u)Pt#€!àÉ‡D†l¨	Ü!ÔcAÀËAT"#ðƒª¥ƒ’ Áh *¦*XtV£ª ´†Ð:MèaÁ  ‡U;Utz¬P:Œ:Hñ¨X êCÑ* `mY@ê€­YPër ë‘­*U3ñà@];­c=[submenuExtTerminal,submenuRad,showTorch];ªd(){bC.clear(1).setFontMonofonto23().setFontAlign(-1,0);­e=0,d=220,c=40;®f=[ÑEXT TERMINAL,Ñ	RAD METER,Ñ
FLASHLIGHT];f.forEach((b,f)¢{fŠa?(bC.setColor(2).fillRect(e,c-21,d,c-18).fillRect(d-3,c-17,d,c+16).fillRect(e,c+17,d,c+20),bC.setBgColor(1).clearRect(e,c-17,d-4,c+16),bC.setColor(3).fillRect(50,c-5,59,c+4)):(bC.setBgColor(0).clearRect(e,c-21,d,c+20),bC.setColor(2)),bC.drawString(b,70,c),c–50}),bC.setBgColor(0).setColor(3),b[a]žbC.drawImage(dc(b[a]),310,90,{rotate:0}),bC.flip()}d();ªe(b){£(b){­c=a;a=E.clip(a-b,0,2),aŒcžPip.knob1Click(b),d()}¤c[a]ž(Pip.audioStartVar(Pip.audioBuiltin(ÑOK)),Pip.removeSubmenu(),c[a]())}­f=setInterval(ª(){bC.flip()},50);Pip.on(Ñknob1,e),Pip.removeSubmenu=ª(){Pip.removeListener(Ñknob1,e),clearInterval(f)}};­submenuExtTerminal=()¢{E.setUSBHID({reportDescriptor:Ñ?	¡u•à)ç %•u•u)‘•u‘•u %h )h À});¬c=0;ªd(){c˜,E.sendUSBHID([0,0,0,0,0,0,0,0])?e():(bC.clear().setFontAlign(0,-1).setColor(3),drawVaultTecLogo(199,15,bC),bC.setFontMonofonto23().drawString(Ñ
Connecting+[Ñ.  ,Ñ.. ,Ñ...][c%3],199,115,!0),bC.setFontMonofonto16().drawString(ÑPlease reconnect USB,199,145,!0),bC.flip())}ªe(){ªf(b,a){E.sendUSBHID([j,0,b,0,0,0,0,0]),setTimeout(ª(){E.sendUSBHID([j,0,0,0,0,0,0,0]),ažsetTimeout(a,5)},5),Pip.kickIdleTimer()}ªn(a,d,b){b=b 20;¬e=setInterval(ª(){a.length?(a[0]¹cžf(c[a[0]]),a=a.substr(1)):(clearInterval(e),džd())},b)}ªo(){Pip.removeSubmenu(),¾Pip.removeSubmenu,bC.clear().setFontAlign(0,-1).setColor(3),drawVaultTecLogo(199,15,bC),bC.setFontMonofonto23().drawString(Ñ
Sending...,199,115,!0),bC.flip()}ªg(a){polys=[[200,20,220,40,210,40,210,60,190,60,190,40,180,40],[200,180,220,160,210,160,210,140,190,140,190,160,180,160],[100,100,120,80,120,90,140,90,140,110,120,110,120,120],[300,100,280,80,280,90,260,90,260,110,280,110,280,120]],bC.setFontMonofonto23().setFontAlign(0,0),hžclearTimeout(h),h=setTimeout(b¢{polys.forEach((b,c)¢{bC.setColor(aŠc?3:1).fillPoly(b)}),bC.setColor(0),bC.setBgColor(aŠ4?3:1).clearRect(165,85,235,115).drawString(ÑENTER,200,101),bC.setBgColor(aŠ5?3:1).clearRect(275,25,345,55).drawString(ÑESC,310,41),bC.setBgColor(aŠ6?3:1).clearRect(275,145,345,175).drawString(d.labels[d.keyIndex],310,161),bC.setBgColor(0),h=¶,bC.flip()},a‹¶?100:0)}ªe(){g(¶)}ªp(){E.showMenu({'':{title:ÑTerminal Connected},ÑHello World:ª(){o(),n(ÑHELLO WORLD,p)}})}ªk(a){a?a<0?(g(1),f(c.DOWN,e)):(g(0),f(c.UP,e)):(g(4),f(c.ENTER,e))}ªl(a){a<0?(g(2),f(c.LEFT,e)):(g(3),f(c.RIGHT,e))}ªm(){g(5),f(c.ESC,e)}ªi(a){d.v=a,a?(d.keyIndex=(d.keyIndex+a+d.keys.length)%d.keys.length,e()):(g(6),f(d.keys[d.keyIndex],e))}Pip.HIDenabled=!0;¬c={A:4,B:5,C:6,D:7,E:8,F:9,G:10,H:11,I:12,J:13,K:14,L:15,M:16,N:17,O:18,P:19,Q:20,R:21,S:22,T:23,U:24,V:25,W:26,X:27,Y:28,Z:29,1:30,2:31,3:32,4:33,5:34,6:35,7:36,8:37,9:38,0:39,ENTER:40,Ñ
:40,ESC:41,BACKSPACE:42,Ñ	:43,Ñ :44,Ñ-:45,Ñ=:46,Ñ[:47,Ñ]:48,Ñ\:49,NUMBER:50,Ñ;:51,Ñ':52,Ñ~:53,Ñ,:54,Ñ.:55,Ñ/:56,CAPS_LOCK:57,F1:58,F2:59,F3:60,F4:61,F5:62,F6:63,F7:64,F8:65,F9:66,F10:67,F11:68,F12:69,PRINTSCREEN:70,SCROLL_LOCK:71,PAUSE:72,INSERT:73,HOME:74,PAGE_UP:75,DELETE:76,END:77,PAGE_DOWN:78,RIGHT:79,LEFT:80,DOWN:81,UP:82,NUM_LOCK:83,PAD_SLASH:84,PAD_ASTERIX:85,PAD_MINUS:86,PAD_PLUS:87,PAD_ENTER:88,PAD_1:89,PAD_2:90,PAD_3:91,PAD_4:92,PAD_5:93,PAD_6:94,PAD_7:95,PAD_8:96,PAD_9:97,PAD_0:98,PAD_PERIOD:99},j=0;­h;­d={v:¶,keys:[c[Ñ	],c[Ñ ],c.DELETE,c.BACKSPACE,c.HOME,c.END],labels:[ÑTAB,ÑSPACE,ÑDEL,ÑBACK,ÑHOME,ÑEND],keyIndex:0};clearInterval(b),b=·,clearInterval(a),a=setInterval(()¢{BTN_PLAY.read()?d.vŠ¶ži(0):BTN_TUNEUP.read()?d.vŠ¶ži(1):BTN_TUNEDOWN.read()?d.vŠ¶ži(-1):d.v=¶,bC.flip()},50),Pip[Ñ#onknob1_old]=Pip[Ñ#onknob1],¾Pip[Ñ#onknob1],Pip[Ñ#onknob2_old]=Pip[Ñ#onknob2],¾Pip[Ñ#onknob2],Pip[Ñ#ontorch_old]=Pip[Ñ#ontorch],¾Pip[Ñ#ontorch],Pip.on(Ñknob1,k),Pip.on(Ñknob2,l),Pip.on(Ñtorch,m),Pip.removeSubmenu=ª(){ažclearInterval(a),Pip.removeListener(Ñknob1,k),Pip.removeListener(Ñknob2,l),Pip.removeListener(Ñtorch,m),Pip[Ñ#onknob1]=Pip[Ñ#onknob1_old],¾Pip[Ñ#onknob1_old],Pip[Ñ#onknob2]=Pip[Ñ#onknob2_old],¾Pip[Ñ#onknob2_old],Pip[Ñ#ontorch]=Pip[Ñ#ontorch_old],¾Pip[Ñ#ontorch_old],Pip.HIDenabled=!1},bC.clear(),e()}¬b=setInterval(d,1e3),a=setInterval(()¢bC.flip(),50);Pip.removeSubmenu=ª(){bžclearInterval(b),ažclearInterval(a)},d()};­submenuApparel=()¢{­b=ÒÖPROCEDURES!

Vault-Tec provides all clothing, bedding, and accommodations for residents.

Personal belongings must be reviewed and approved of by an authorized Vault-Tec hermetics technician before such belongings can be delivered to your reserved quarters within the Vault.

All Vault residents must attend an orientation seminar. If you did not attend such a seminar as part of the application process, you must make an appointment with your Vault-Tec representative.
;bC.setFontMonofonto16().setFontAlign(-1,-1).setColor(3);­a=-223,c;ªd(b){a—b*10,a<-400ž(a=200),a>200ž(a=-400)}ªe(){acž(c=a,bC.clear(),a>-100ždrawVaultTecLogo(199,a+15,bC),bC.drawString(b,20,a+120)),bC.flip()}Pip.typeText(b).then(()¢{b=bC.wrapString(b,350).join(Ñ
),Pip.drawInterval=setInterval(e,50),Pip.on(Ñknob1,d)}),Pip.removeSubmenu=ª(){Pip.typeTimerž(clearInterval(Pip.typeTimer),¾Pip.typeTimer),Pip.drawIntervalž(clearInterval(Pip.drawInterval),¾Pip.drawInterval,Pip.removeListener(Ñknob1,d))}};­submenuStats=()¢{®e={x:36,y:41,repeat:!0};­a=fs.readdirSync(ÑMISC).sort().filter(a¢a.toUpperCase().endsWith(ÑAVI)ž!a.startsWith(Ñ.));£(!a.length)«;­b=Math.floor(a.length*Math.random()*.999);­c=!1;­d=setTimeout(ª(){d=·,Pip.videoStart(`MISC/${a[b]}`,e)},200);ªf(d){£(dŠ0 c)«;c=!0,b=(b+a.length+d)%a.length,Pip.knob1Click(d),setTimeout(d¢{g.clearRect(36,41,444,288),Pip.videoStart(`MISC/${a[b]}`,e),c=!1},100)}Pip.on(Ñknob1,f),Pip.removeSubmenu=ª(){džclearTimeout(d),Pip.videoStop(),Pip.removeListener(Ñknob1,f)}};­submenuAbout=()¢{­g=ÒÒËY AD`:AÔr¬ ’(6d•— $Šª%GšÐ	"Šê¨H`Z­!*)U $†
 ´¢µf²HaV­Hy¸ÀH†Õ 	)ð…j“£	T¶iuZBšƒ‚·ààš­×«¨ÂH¬øI5èvIaÆ‹ ƒ¥ƒ°Z¿{Ü €$¢É`¸ µYX®i ¸$Y,
 ’U¬@€áY„‹¥ƒZµU­u€w %^ðƒT*¤ W"é`à8mV»QPØ1 ¿€…ïmQÿbP$ÀIeÿ°k6ÿ
¨ßå,‘”£p¾?ÿÿGU’†º	KÛÿù5Zª?ÿÅœ5 ßÅj–­V¦¤Ñ‰`5¢P:šQ± <¿ Œ X«'@JÕþ^¹ K? 	ƒø7ôa I@hBSSúö4•
Q¿	€þ!G :ªT’ž•nÈK’ÅIF ÛX-&‹/]4»¥’K”#¢ø›¿J¡é`iRTüHÜÅ¨K’¥F²~+sùVƒÿ€Ñaµ3âSº¬òi¡ÕhÉNO¥Z¨ô6QjÔ¥\ƒ’ÔB’€êœßmZ¬–ªÕKèF¡ümV“A2£j´¿#PÆ«S(„ÏN ÓúV§õ­U*úZµã{~ 8
ÿ£ªÉœ€è&¿úX€ÞÕ)(¢_ýj7Ë¦‰@¥Åi7é`WmÂüU$ :¬XU£€4’Õª¥ÿòñ0XãI
•jµÿþ?¡P±©…Ö XmV©,÷q+1´D¨ :¬?ÿÍ7ØÀi:” :­IÀT
€%_I©ÚA±D ´Ÿÿö.š%_Q-¼À²@µTÿïS-…M¨,ŽÿÙ²h«G°=	EþŒo
ÿŸÿÐv‰Uô¨VŸý/ó_üq"ò‰$ëEKÿAr’ÿÆ[û$Œ	…@¢-dý@·ÿaÙxLBÀ%[ª¡`°ÿþÿû ¸ð5T1"Ð˜l&p€	Aÿ@ :
¬’`%Za¤G€ Æÿ 0o*L$H´`ÚGA"Z p˜@J¶z	 J¨ €­0*ÅBþ ”¢q`#ZXŒ[k Ê^#ì @
C`=
†bµjªF‚ÿú% Y°àb€ “¯ÿK+`”B 7‡PŠp²Y$üJV ŽÀ K5¦í“À%0	ÿÀJ¤½¤¢¡PhªR5 €ïWj€º@4d¸8h„(`«Ä
‘ÀB"¡#M
¼$v[Ê€Á‹jDn€‚ê÷{ª ‘ðàÀ@ÿÿ¤zÿè@ø	äÀm%ÿ@ 2êéèCáØ| „zÿÅÐ|ðp3Èxœìy¡þú _øoÿ‚À¾Ð˜=ô ” ¤è'¡èm%°ò8>¤¸2âþ
@—¼O >Y(¡Œl~€÷@7Á€¯``ø>â_ßøm#ð=Äñ-ñð¡ =ÅÒ;ð…†–¦Á+ƒ‚÷ûÂÀü.ü	¡,Ú‡Køô\K%|%~
ñ-Þ’‚ƒË _Ùl¾”,ç¬ØK.»á(SX.<øÇ¡-ù:Að‚ÿ¸è5šóàx:×–J&@à

uå°À$ wÿè_ô”Þ»ðšN!tÒQ$aèCÁ-›t ¥Gƒü?Ðziÿ% Jƒ ŽÃà]2!R£ßáý
öòGú8%@~¾Øù(¨Ãùÿô6“òP7ƒhX2PÓòÐD¢çð¾À
”<€ƒé.nJîˆPÛñp0?ð^ðýÿðv³
	(KÄ…Ð¾’‡4‚¥ô—ý
ÀË‰ ý @Ðàô	ä¶Ð(;­c=E.getTemperature();­d=()¢{­b=process.memory();­d=Pip.measurePin(VUSB_MEAS);­e=Pip.measurePin(VBAT_MEAS);­f=CHARGE_STAT.read()Š0;c=c*.99+E.getTemperature()*.01;­a=Ñ5============ Pip-Boy 3000 Mark V ===========

Pip-OS +process.env.VERSION+Ñ - +VERSION+Ñ
Serial number: +Pip.getID()+Ñ

;«settings.userNamež(a–ÑPip-Boy assigned to +settings.userName+Ñ

),a–`Battery: ${e.toFixed(1)}V`,d>1?(a–`, USB: ${d.toFixed(1)}V`,f?a–Ñ (charging)
:e>4?a–Ñ (charged)
:a–Ñ (not charging)
):a–Ñ (not charging)
,a–Ñ
Memory used: +b.usage+Ñ/+b.total+Ñ blocks
Core temperature: +c.toFixed(1)+Ñ C

,a–Ñ(Built for Vault-Tec by The Wand Company
,a};bC.setFontMonofonto16().setFontAlign(-1,-1).setColor(3);­e=d().split(Ñ
).length*bC.getFontHeight();­a=90-e,b=-200-e;ªf(c){a—c*10,a<bž(a=190),a>190ž(a=b)}ªh(){bC.clear(),a>-100?drawVaultTecLogo(199,a+15,bC):a<310+bžbC.drawImage(dc(g),125,a-90-b),bC.drawString(d(),20,a+120),bC.flip()}Pip.typeText(d()).then(()¢{Pip.drawInterval=setInterval(h,50),Pip.on(Ñknob1,f);­a=0;scrollInterval=setInterval(ª(){f(1),˜a>8žclearInterval(scrollInterval)},100)}),Pip.removeSubmenu=ª(){Pip.typeTimerž(clearInterval(Pip.typeTimer),¾Pip.typeTimer),Pip.drawIntervalž(clearInterval(Pip.drawInterval),¾Pip.drawInterval,Pip.removeListener(Ñknob1,f))}};­getUserVideos=()¢{¬a=[];±{a=fs.readdirSync(ÑUSER).filter(a¢a.toUpperCase().endsWith(ÑAVI)ž!a.startsWith(Ñ.))}catch(a){}«a};­submenuVideos=()¢{¬b=getUserVideos();ªc(b){ªa(a){a submenuVideos()}Pip.removeSubmenu(),Pip.videoStart(ÑUSER/+b),Pip.on(Ñknob1,a),Pip.removeSubmenu=ª(){g.clear(),bH.flip(),drawFooter(),Pip.removeListener(Ñknob1,a),Pip.videoStop()}}¬a={};b.length?(b.forEach(b¢{a[b.slice(0,-4)]=ª(){c(b)}}),a[Ñ< Back]=submenuMaintenance,E.showMenu(a)):(Pip.removeSubmenužPip.removeSubmenu(),¾Pip.removeSubmenu,submenuBlank(ÑNO VIDEOS
ADD TO 'USER' DIR)())};­getUserAudio=()¢{¬a=[];±{a=fs.readdirSync(ÑUSER).filter(a¢a.toUpperCase().endsWith(ÑWAV)ž!a.startsWith(Ñ.))}catch(a){}«a};­submenuAudio=()¢{¬b=getUserAudio(),a={};b.length?(b.forEach(b¢{a[b.slice(0,-4)]=ª(){Pip.audioStart(ÑUSER/+b)}}),a[Ñ< Back]=submenuMaintenance,E.showMenu(a)):(Pip.removeSubmenužPip.removeSubmenu(),¾Pip.removeSubmenu,submenuBlank(Ñ NO AUDIO FILES
ADD TO 'USER' DIR)())};­getUserApps=()¢{¬a=[];±{a=fs.readdirSync(ÑUSER).filter(a¢a.toUpperCase().endsWith(ÑJS)ž!a.startsWith(Ñ.))}catch(a){}«a};­submenuApps=()¢{¬files=getUserApps();ªstartApp(app){Pip.removeSubmenužPip.removeSubmenu(),¾Pip.removeSubmenu,Pip.removežPip.remove(),¾Pip.remove,g.clear(BGRECT),g.reset().setFontMonofonto28().setFontAlign(0,0),g.drawString(ÑLoading
+app,BGRECT.x+BGRECT.w/2,BGRECT.y+BGRECT.h/2),eval(fs.readFile(ÑUSER/+app))}¬menu={};£(files.length){¬nameMap={};±{fs.readdirSync(ÑAPPINFO).forEach(b¢{£(!fs.statSync(ÑAPPINFO/+b).dir){¬a=JSON.parse(fs.readFile(ÑAPPINFO/+b));nameMap[a.id]=a.name}})}catch(a){}files.forEach(b¢{¬a=b.slice(0,-3);a¹nameMapž(a=nameMap[a]),menu[a]=ª(){startApp(b)}}),E.showMenu(menu)}¤Pip.removeSubmenužPip.removeSubmenu(),¾Pip.removeSubmenu,submenuBlank(ÑNO JS FILES
ADD TO 'USER' DIR)()};­submenuSetAlarm=()¢{¬b,a={ÑSet alarm time:ª(){Pip.removeSubmenu(),¾Pip.removeSubmenu,submenuSetAlarmTime()},ÑAlarm sound:{value:settings.alarm.soundIndex,min:0,max:settings.alarm.soundFiles.length,step:1,format:a¢a‘settings.alarm.soundFiles.length?ÑFM +rd.freq.toFixed(1):settings.alarm.soundFiles[a].slice(0,-4),onchange:a¢{settings.alarm.soundIndex=a,a<settings.alarm.soundFiles.length?Pip.audioStart(ÑALARM/+settings.alarm.soundFiles[a]):Pip.audioStop(),bžclearTimeout(b),b=setTimeout(ª(){saveSettings()},5e3)}},ÑAlarm on/off:{value:settings.alarm.enabled,format:a¢a?ÑOn:ÑOff,onchange:a¢{settings.alarm.enabled=a,saveSettings(),configureAlarm(),drawFooter()}},ÑRepeat alarm each day?:{value:settings.alarm.repeat,format:a¢a?ÑYes:ÑNo,onchange:a¢{settings.alarm.repeat=a,saveSettings(),console.log(ÑAlarm repeats:,settings.alarm.repeat?ÑYes:ÑNo)}},Snooze:{value:0|settings.alarm.snooze,format:a¢a?a+Ñ min:ÑOff,min:1,max:30,step:1,onchange:a¢{settings.alarm.snooze=a,saveSettings(),console.log(Ñ
Alarm snooze:,settings.alarm.snooze)}}};settings.alarm.snoozeTimež(a[Ñ
Cancel Snooze]=ª(){¾settings.alarm.snoozeTime,saveSettings(),configureAlarm(),drawFooter(),submenuSetAlarm()}),a[Ñ< Back]=submenuMaintenance,E.showMenu(a)};­submenuMaintenance=()¢{¬a,b={ÑSet date & time:ª(){Pip.removeSubmenu(),submenuSetDateTime()},ÑTimezone (offset from UTC):{value:settings.timezone 0,min:-12,max:14,step:1,format:a¢(a>0?Ñ++a:a)+(aŠ1 aŠ-1?Ñ hr:Ñ hrs),onchange:(b,c)¢{settings.timezone=b,E.setTimeZone(b),settings.alarm.timež(settings.alarm.time—c*36e5),drawFooter(),ažclearTimeout(a),a=setTimeout(ª(){saveSettings()},5e3)}},Ñ12/24 hour display:{value:!!settings.clock12hr,format:a¢a?Ñ12 hr:Ñ24 hr,onchange:a¢{settings.clock12hr=a,drawFooter(),saveSettings(),console.log(Ñ12/24 hour display set to,settings.clock12hr?Ñ12 hr:Ñ24 hr)}},Ñ	Set alarm:ª(){Pip.removeSubmenu(),submenuSetAlarm()},ÑDisplay timeout:{value:settings.idleTimeout?Math.round(settings.idleTimeout/6e4):31,min:1,max:31,step:1,format:a¢a<31?a+Ñ min:ÑNever,onchange:b¢{settings.idleTimeout=b<31?b*6e4:0,ažclearTimeout(a),a=setTimeout(ª(){saveSettings()},5e3)}},ÑDisplay brightness:{value:Pip.brightness,min:1,max:20,step:1,onchange:a¢{Pip.brightness=a,Pip.updateBrightness()}},Ñ
Display color:ª(){Pip.removeSubmenu(),submenuPalette()},Ñ	Demo mode:enterDemoMode,About:ª(){Pip.removeSubmenu(),submenuAbout()},Reboot:ª(){clearWatch(),clearInterval(),E.showMessage(ÑRebooting...),setTimeout(E.reboot,2e3)}};getUserVideos().lengthž(b[ÑPlay videos]=submenuVideos),getUserAudio().lengthž(b[ÑPlay audio files]=submenuAudio),E.showMenu(b)};­drawHeader=b¢{­a=50;bH.clear(1).setFontMonofonto18().setFontAlign(-1,-1),bH.drawImage(dc(icons.cog),1,1),modes.forEach((c,d)¢{bŠd+1žbH.drawPoly([0,28,a-10,28,a-10,14,a-5,14]),bH.drawString(c,a,7),a–c.length*9,bŠd+1žbH.drawPoly([a+5,14,a+10,14,a+10,28,369,28]),a–24}),bH.drawImage(dc(icons.holotape),345,1);­c=MODEINFO[b];c.submenuž(a=50,Object.keys(c.submenu).forEach((b,c)¢{bH.setColor(15/(1+Math.abs(c-sm0))).drawString(b,a,34),a–bH.stringWidth(b)+10})),bH.flip()};­drawFooter=()¢{­a=Pip.getDateAndTime();­g=(a.getMonth()+1).twoDigit();­h=a.getDate().twoDigit();­e=a.getHours();­i=settings.clock12hr?((e+11)%12+1).toString().padStart(2,Ñ ):e.twoDigit();­j=a.getMinutes().twoDigit();­k=a.getFullYear()+Ñ-+g+Ñ-+h+Ñ +i+Ñ:+j;bF.clear(1).setBgColor(1).setColor(3),bF.clearRect(0,0,148,24).clearRect(152,0,238,24).clearRect(242,0,371,24),bF.setFontMonofonto16().setFontAlign(-1,-1).drawString(k,10,4),bF.drawRect(162,5,212,19).fillRect(212,9,215,15);­c=Pip.measurePin(VBAT_MEAS);­d=3.5,f=4.1;VUSB_PRESENT.read()?(bF.drawImage(dc(icons.charging),223,4),CHARGE_STAT.read()Š0ž(d=3.6,f=4.2)):c<3.5ž(bF.drawString(Ñ!,224,4),c<3.3žPip.sleeping‹!1žPip.offOrSleep({immediate:!1,forceOff:!0}));­b=(c-d)/(f-d)*48;£(b<1ž(b=1),b>48ž(b=48),bF.setColor(2).fillRect(163,6,163+b,18).setColor(3),Pip.demoMode)bF.drawString(Ñ	DEMO MODE,252,4);¤£(settings.alarm.time){­a=¸Date(settings.alarm.time);­b=0;bF.setColor(settings.alarm.enabled?3:2),settings.alarm.snoozeTimež(a=¸Date(settings.alarm.snoozeTime),bF.drawImage(icons.snooze,250,3),b=21),bF.drawString(a.getHours().twoDigit()+Ñ:+a.getMinutes().twoDigit(),252+b,4),bF.drawImage(dc(settings.alarm.enabled?icons.alarm:icons.noAlarm),300+b,3)}bF.flip(),(Pip.radioOn Pip.brightness<20)ž!Pip.audioIsPlaying()žPip.audioStartVar(¸Uint8Array(Pip.radioOn?4:2))};­mPrev=¶;­checkMode=()¢{­b=MODE_SELECTOR.analog();­a=1;£(b>.9?(pinMode(MEAS_ENB,Ñinput),pinMode(MEAS_ENB,Ñoutput),MEAS_ENB.write(0),a=settings.fallbackMode):b>.7?a=5:b>.5?a=4:b>.3?a=3:b>.1ž(a=2),Pip.demoModež(a=mPrev=Pip.demoMode),aŠmPrevžaŒPip.mode){Pip.kickIdleTimer(),sm0=0,Pip.removeSubmenužPip.removeSubmenu(),¾Pip.removeSubmenu,g.setBgColor(0).clearRect(BGRECT);­b=MODEINFO[a];£(bžb.submenu){­a=Object.keys(b.submenu);b.submenu[a[sm0]]()}¤bžb.fnžb.fn();Pip.modeŠ¶?drawFooter():Pip.audioStart(ÑUI/ROT_H_1.wav),drawHeader(a),Pip.mode=a}mPrev=a;­c=Date();c.getMinutes()Œd0ž(drawFooter(),d0=c.getMinutes()),BTN_PLAY.read()ž!Pip.HIDenabled?(Pip.btnPlayPrev (Pip.kickIdleTimer(),Pip.modeŠMODE.RADIO?radioPlayClip():KNOB1_BTN.read() (rd.enable(!Pip.radioOn),Pip.audioStart(Pip.radioOn?ÑUI/RADIO_ON.wav:ÑUI/RADIO_OFF.wav))),Pip.btnPlayPrev=!0):Pip.btnPlayPrev=!1,BTN_TUNEUP.read()?(!Pip.btnUpPrevžPip.radioOnž(Pip.kickIdleTimer(),Pip.audioStart(ÑRADIO/TUNING.wav),rd.seek(1)),Pip.btnUpPrev=!0):Pip.btnUpPrev=!1,BTN_TUNEDOWN.read()?(!Pip.btnDownPrevžPip.radioOnž(Pip.kickIdleTimer(),Pip.audioStart(ÑRADIO/TUNING.wav),rd.seek(0)),Pip.btnDownPrev=!0):Pip.btnDownPrev=!1};­createDateTimeSubmenu=(a,d,h,i)¢{Pip[Ñ#onknob2_old]=Pip[Ñ#onknob2],¾Pip[Ñ#onknob2],a.setSeconds(0);­b=d?0:3;­f=()¢{­b=a.getHours().twoDigit();­c=a.getMinutes().twoDigit();bC.reset().setFontMonofonto28().setFontAlign(-1,-1),d?(bC.drawString(a.getFullYear(),77,83,!0),bC.drawString(Ñ-,136,83),bC.drawString((a.getMonth()+1).twoDigit(),153,83,!0),bC.drawString(Ñ-,184,83),bC.drawString(a.getDate().twoDigit(),201,83,!0),bC.drawString(b,249,83,!0),bC.drawString(Ñ:,280,83),bC.drawString(c,297,83,!0)):(bC.drawString(b,162,83,!0),bC.drawString(Ñ:,193,83),bC.drawString(c,210,83,!0))};­e=(f,g,h,i,a)¢{aŠ¶ž(a=1);­b=f,c=f+h,d=g,e=g+i;¦(a™)bC.drawRect(b,d,c,e),b˜,c™,d˜,e™};­c=c¢{cŠ¶ž(c=3);­f;d?f=[[73,76,64,42,2],[149,76,36,42,2],[197,76,36,42,2],[245,76,36,42,2],[293,76,36,42,2],[150,145,100,33,1]]:f=[[],[],[],[158,76,36,42,2],[206,76,36,42,2],[150,145,100,33,1]],bC.setColor(c);­a=f[b];bŠ5ž(bC.setBgColor(1).clearRect(a[0],a[1],a[0]+a[2],a[1]+a[3]),bC.setFontMonofonto23().setFontAlign(0,-1),bC.drawString(ÑSET,200,150).setBgColor(0)),e(a[0],a[1],a[2],a[3],a[4])};Pip.removeSubmenu=()¢{clearInterval(g),Pip.removeAllListeners(Ñknob1),Pip.removeAllListeners(Ñknob2),Pip[Ñ#onknob2]=Pip[Ñ#onknob2_old],¾Pip[Ñ#onknob2_old]},Pip.on(Ñknob1,d¢{£(d){»(b){¼0:a.setFullYear(a.getFullYear()+d);¨;¼1:a.setMonth(a.getMonth()+d);¨;¼2:a.setDate(a.getDate()+d);¨;¼3:a.setHours(a.getHours()+d);¨;¼4:a.setMinutes(a.getMinutes()+d);¨}f()}¤b‘5?(Pip.audioStartVar(Pip.audioBuiltin(ÑOK)),setTimeout(i,700,a)):(Pip.audioStartVar(Pip.audioBuiltin(ÑNEXT)),c(0),b˜,c());bC.flip()}),Pip.on(Ñknob2,a¢{Pip.audioStartVar(Pip.audioBuiltin(ÑCOLUMN)),c(bŠ5?.3:0),d?b=(b+a+6)%6:b=(b+a+3)%3+3,c(),bC.flip()}),bC.clear().setFontMonofonto28().setColor(2).setFontAlign(0,-1),bC.drawString(h,200,23),bC.setFontMonofonto23().setColor(1),bC.drawString(ÑSET,200,150),bC.drawRect(150,145,250,178),d?e(48,69,306,56,3):e(124,69,152,56,3),drawHeader(3),drawFooter(),f(),c(),bC.flip();­g=setInterval(ª(){bC.flip()},50)};­submenuSetDateTime=()¢createDateTimeSubmenu(Pip.getDateAndTime(),!0,ÑSET DATE & TIME,a¢{Pip.setDateAndTime(a),showMainMenu()});­submenuSetAlarmTime=()¢{¬a=Pip.getDateAndTime();­b=7,c=0;£(settings.alarm.time){¬d=¸Date(settings.alarm.time);b=d.getHours(),c=d.getMinutes()}«a.setHours(b),a.setMinutes(c),a.setSeconds(0),createDateTimeSubmenu(a,!1,Ñ	SET ALARM,a¢{settings.alarm.time=a.getTime(),¾settings.alarm.snoozeTime,settings.alarm.enabled=!0,drawFooter(),saveSettings(),configureAlarm(),submenuSetAlarm()})};­submenuPalette=()¢{¬a={r:0,g:255,b:0,scanline:128,overscan:128};­j=()¢{setTimeout(ª(){Pip.removeSubmenu(),submenuMaintenance()},200)};¬k=10,l=27,b=[{n:ÑRed,id:Ñr},{n:ÑGreen,id:Ñg},{n:ÑBlue,id:Ñb},{n:ÑSet to default (green),fn:()¢e(0,255,0)},{n:ÑSet to amber,fn:()¢e(255,112,0)},{n:ÑSet to white,fn:()¢e(255,255,255)},{n:Ñ< Back,fn:j}];b.forEach((a,b)¢a.y=k+b*l);¬c=0;pal=[¸Uint16Array(16),¸Uint16Array(16),¸Uint16Array(16),¸Uint16Array(16)];­m=(b,d,e)¢{¬c=170+Math.round(d*170/256),a=b.y;bC.reset().setFontMonofonto18().setFontAlign(-1,-1),ežbC.setBgColor(3).setColor(0).clearRect(10,a,380,a+27),bC.drawString(b.n,30,a+4),b.idž(bC.fillRect(170,a+5,350,a+6).fillRect(170,a+21,350,a+22).fillRect(c,a+7,c+10,a+20),bC.fillPolyAA([160,13+a,170,5+a,170,22+a]).fillPoly([360,13+a,350,5+a,350,22+a]))};­d=()¢{bC.clear(1),b.forEach((b,d)¢m(b,a[b.id],dŠc))};­e=(b,c,d)¢{a.r=b,a.g=c,a.b=d,f()};­f=()¢{®f=a.r/255;®h=a.g/255;®i=a.b/255;®d=1-a.scanline/255;®e=a.overscan/1275;§(¬b=0;b<16;b˜){¬c=Math.max(0,(b-12)/30);pal[0][b]=g.toColor(c+f*b/15,c+h*b/15,c+i*b/15),pal[1][b]=g.toColor(c+d*f*b/15,c+d*h*b/15,c+d*i*b/15),pal[2][b]=g.toColor(c+(e+f)*b/15,c+(e+h)*b/15,c+(e+i)*b/15),pal[3][b]=g.toColor(c+(e+d*f)*b/15,c+(e+d*h)*b/15,c+(e+d*i)*b/15)}Pip.setPalette(pal)};Pip.removeSubmenu=()¢{settings.color=a,settings.palette=pal.map(a¢btoa(a.buffer)).join(Ñ,),saveSettings(),clearInterval(n),Pip.removeListener(Ñknob1,h),Pip.removeListener(Ñknob2,i)};­h=a¢{E.stopEventPropagation(),Pip.knob1Click(a),a?c=(c+b.length-a)%b.length:b[c].fnžb[c].fn(),d(),bC.flip()};Pip.prependListener(Ñknob1,h);­i=g¢{E.stopEventPropagation();¬e=b[c];e.idž(a[e.id]=E.clip(a[e.id]+g*16,0,255),f(),Pip.knob2Click(g),d(),bC.flip())};Pip.prependListener(Ñknob2,i),settings.colorž(a.r=0|E.clip(settings.color.r,0,255),a.g=0|E.clip(settings.color.g,0,255),a.b=0|E.clip(settings.color.b,0,255),a.scanline=0|E.clip(settings.color.scanline,0,255),a.overscan=0|E.clip(settings.color.overscan,0,255),f()),d(),bC.flip();­n=setInterval(ª(){bH.flip(),bC.flip(),bF.flip()},50)};E.showMenu=ª(g){ªi(a){a?c.move(-a):c.select()}¬b=bC;b.clear(1);¬a=g[''],d=Object.keys(g);až(d.splice(d.indexOf(''),1),a.backž(g[Ñ< Back]=a.back,d.unshift(Ñ< Back))),aºObject (a={}),a.selected‹·ž(a.selected=0),a.rowHeight=27;¬h=10,f=a.x2 b.getWidth()-20,e=12,j=b.getHeight()-1;a.titlež(e–a.rowHeight+2);¬c={draw:ª(){b.reset().setFontMonofonto18(),a.predrawža.predraw(b),b.setFontAlign(0,-1),a.titlež(b.drawString(a.title,(h+f)/2,e-a.rowHeight),b.drawLine(h,e-2,f,e-2));¬o=0|Math.min((j-e)/a.rowHeight,d.length),k=E.clip(a.selected-(o’1),0,d.length-o),i=e,s=k>0;b.setColor(k>0?3:0).fillPoly([190,10,210,10,200,0]);¦(o™){¬q=d[k],l=g[q],r=kŠa.selectedž!c.selectEdit;£(b.setBgColor(r?3:0).clearRect(h,i,f,i+a.rowHeight-1),b.setColor(r?0:3).setFontAlign(-1,-1).drawString(q,h+20,i+4),ÑoŠ(¿l)[0]){¬m=f,n=l.value;£(l.formatž(n=l.format(n)),c.selectEditžkŠa.selected){¬p=a.rowHeight>10?2:1;m—12*p+1,b.setBgColor(3).clearRect(m-(b.stringWidth(n)+4),i,f,i+a.rowHeight-1),b.setColor(0).drawImage({width:12,height:5,buffer:Ñ  ùð @,transparent:0},m,i+(a.rowHeight-5*p)/2,{scale:p})}b.setFontAlign(1,-1).drawString(n.toString(),m-2,i+4)}i–a.rowHeight,k˜}b.setColor(k<d.length?3:0).fillPoly([191,201,210,201,200,210]),b.setColor(3).setBgColor(0).setFontAlign(-1,-1).flip()},select:ª(){¬b=g[d[a.selected]];Pip.audioStartVar(Pip.audioBuiltin(ÑOK)),ÑfŠ(¿b)[0]?b(c):ÑoŠ(¿b)[0]ž(ÑnŠ(¿b.value)[0]?c.selectEdit=c.selectEdit?·:b:(ÑbŠ(¿b.value)[0]ž(b.value=!b.value),b.onchangežb.onchange(b.value)),c.draw())},move:ª(e){£(c.selectEdit){¬b=c.selectEdit;­a=b.value;b.value—(e 1)*(b.step 1),b.min·žb.value<b.minž(b.value=b.wrap?b.max:b.min),b.max·žb.value>b.maxž(b.value=b.wrap?b.min:b.max),b.onchangežb.valueŒažb.onchange(b.value,-e)}¤{­b=a.selected;a.wrapSelection?a.selected=(e+a.selected+d.length)%d.length:a.selected=E.clip(a.selected+e,0,d.length-1),bŒa.selectedž!Pip.radioKPSSžPip.knob1Click(e)}c.draw()}};«Pip.removeSubmenužPip.removeSubmenu(),c.draw(),Pip.on(Ñknob1,i),Pip.removeSubmenu=()¢{Pip.removeListener(Ñknob1,i)},c},E.showPrompt=ª(e,a){ªc(){g.setColor(a.color);¬f=g.getWidth(),n=g.getHeight(),k=a.title;kžg.setFontMonofonto23().setFontAlign(0,-1,0).setBgColor(a.color).drawString(k,f/2,42).setBgColor(0),g.setFontMonofonto18().setFontAlign(0,0,0);¬i=e.split(Ñ
),l=125-i.length*20/2;a.clearBgžg.clearRect((f-i[0].length*8)/2-20,l-20,(f+i[0].length*8)/2+20,175+b.length*20),i.forEach((a,b)¢g.drawString(a,f/2,l+b*20));¬h,c,j,m;h=f/2,c=175-(b.length-1)*20,b.forEach((b,e)¢{b=b,j=50,m=[h-j-4,c-13,h+j+4,c-13,h+j+4,c+13,h-j-4,c+13],g.setColor(eŠa.selected?d:0).fillPoly(m).setColor(a.color).drawPoly(m,1).setFontMonofonto18().drawString(b,h,c+1),c–36}),g.setFontAlign(-1,-1)}¬d=g.blendColor(g.theme.bg,g.theme.fg,.5);a (a={}),a.buttons (a.buttons={Yes:!0,No:!1});¬b=Object.keys(a.buttons);«a.selected (a.selected=0),a.color‹·ž(a.color=g.theme.fg),a.clearBg (a.clearBg=!0),c(),¸Promise(f¢{­d=!0;ªe(g){g?d?(a.selected—g,a.selected<0ž(a.selected=0),a.selected‘b.lengthž(a.selected=b.length-1),c(),d=!1):d=!0:(Pip.removeListener(Ñknob1,e),f(a.buttons[b[a.selected]]))}Pip.on(Ñknob1,e),Pip.removeSubmenu=()¢{Pip.removeListener(Ñknob1,e)}})},E.showMessage=ª(a){g.clear(1),bC.clear(1).setColor(3).setFontMonofonto23().setFontAlign(0,0),drawVaultTecLogo(200,48-12*a.split(Ñ
).length,bC),bC.drawString(a,200,156).flip()},MODEINFO=[0,{name:ÑSTAT,submenu:{STATUS:submenuStatus,CONNECT:submenuConnect,DIAGNOSTICS:submenuDiagnostics}},{name:ÑINV,submenu:{ATTACHMENTS:submenuInvAttach,APPAREL:submenuApparel,APPS:submenuApps,AID:showVaultAssignment}},{name:ÑDATA,submenu:{CLOCK:submenuClock,STATS:submenuStats,MAINTENANCE:submenuMaintenance}},{name:ÑMAP,fn:submenuMap},{name:ÑRADIO,fn:submenuRadio}],getUserApps().length ¾MODEINFO[2].submenu.APPS,Pip.setPalettežsettings.palettežPip.setPalette(settings.palette.split(Ñ,).map(a¢¸Uint16Array(E.toArrayBuffer(atob(a))))),checkBatteryAndSleep() (KNOB1_BTN.read()žBTN_POWER.read()?(log(ÑEntering factory test mode),factoryTestMode()):Pip.isSDCardInserted()?(Pip.addWatches(),KNOB1_BTN.read()?(log(ÑBooting into demo mode),enterDemoMode()):settings.longPressToWake?(log(ÑPlaying boot animation),settings.longPressToWake=!1,saveSettings(),playBootAnimation()):(Pip.sleeping=ÑBUSY,Pip.fadeOn(),fs.statSync(ÑBOOT)?(log(ÑNormal boot - showing main menu),setTimeout(a¢{Pip.fadeOff().then(a¢{Pip.audioStart(ÑBOOT/BOOT_DONE.wav),Pip.sleeping=!1,showMainMenu(),Pip.fadeOn()})},2e3)):(log(Ñ*** NO BOOT DIRECTORY ***),g.drawString(ÑNO BOOT DIRECTORY,240,174,1),Pip.sleeping=!1))):(Pip.fadeOn(),setWatch(Pip.off,BTN_POWER,{edge:Ñfalling})))
